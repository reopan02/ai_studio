import{d as Ie,r as g,j as P,k as Z,o as Ke,c as i,a as l,b as t,e as m,f as O,i as C,w as p,p as pe,q as re,v as _,F as $,m as I,n as K,t as h,s as Q,h as W,l as B,u as je,g as Ae}from"./runtime-dom.esm-bundler-CzCxjph-.js";const ze={class:"ecommerce-image-page"},Oe={class:"header"},He={class:"header-actions"},Ee={class:"main-container"},Le={class:"sidebar"},Re={key:0,class:"sidebar-section"},De={class:"form-group"},Fe={class:"input-wrapper"},Ne=["type"],Je={class:"form-group"},Xe={class:"input-wrapper"},qe=["type"],Ge={class:"sidebar-section"},Ze={class:"form-group",style:{"margin-top":"16px"}},Qe={class:"form-group"},We={class:"sidebar-section"},Ye={class:"search-wrapper"},et={key:0,class:"product-list"},tt=["onClick"],st=["src","alt"],nt={class:"product-info"},ot={class:"product-name"},it={class:"product-meta"},lt={key:1,class:"product-list-empty"},at={key:2,class:"product-list-loading"},rt={key:3,class:"pagination"},dt=["disabled"],ut={class:"page-info"},ct=["disabled"],pt={key:1,class:"sidebar-section"},vt={class:"section-title"},gt={key:0,class:"image-grid"},mt=["onClick"],ht=["src"],ft={key:0,class:"image-check"},yt={key:1,class:"image-primary"},kt={key:1,class:"no-images"},bt={class:"main-content"},wt={key:0,class:"content-panel"},xt={class:"product-fields"},Ct={class:"field-row"},_t={class:"field-checkbox"},Bt=["disabled"],Ut={class:"field-row"},St={class:"field-checkbox"},Mt=["disabled"],Tt={class:"field-row"},Vt={class:"field-checkbox"},Pt=["disabled"],$t={class:"field-row"},It={class:"field-checkbox"},Kt=["disabled"],jt={class:"content-panel"},At={class:"template-module"},zt={class:"module-header"},Ot={class:"option-chips"},Ht=["onClick"],Et=["onUpdate:modelValue"],Lt=["onClick"],Rt=["onClick"],Dt={class:"template-module"},Ft={class:"module-header"},Nt={class:"option-chips"},Jt=["onClick"],Xt=["onUpdate:modelValue"],qt=["onClick"],Gt=["onClick"],Zt={class:"template-module"},Qt={class:"module-header"},Wt={class:"option-chips"},Yt=["onClick"],es=["onUpdate:modelValue"],ts=["onClick"],ss=["onClick"],ns={class:"template-module"},os={class:"module-header"},is={class:"option-chips"},ls=["onClick"],as=["onUpdate:modelValue"],rs=["onClick"],ds=["onClick"],us={class:"content-panel prompt-preview-panel"},cs={class:"panel-header"},ps=["disabled"],vs={class:"prompt-preview"},gs={key:0},ms={key:1,class:"prompt-placeholder"},hs={class:"result-area"},fs={key:0,class:"result-placeholder"},ys={key:1,class:"loading-state"},ks={key:2,class:"result-container"},bs=["src"],ws={class:"generate-section"},xs=["disabled"],Cs={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},_s={key:1,class:"spinner-small"},Bs={key:0,class:"generate-hint"},Us={class:"toast-container"},Y=10,Ss=Ie({__name:"ecommerce-image-page",setup(Ms){const U={scene:["白色背景","自然光桌面","户外场景","纯色背景","生活场景"],angle:["正面","45度侧面","俯视","平视","特写"],style:["柔和光影","高对比度","自然光","专业棚拍","暖色调"],target:["主图","详情页","海报","白底图","场景图"]},ee=g(!1),te=g(!1),se=g(!1),y=P({apiKey:"",baseUrl:""}),k=P({model:"gpt-image-1.5",aspectRatio:"",imageSize:""}),E=g([]),L=g(!1),R=g(""),w=g(1),ne=g(0),V=g(null),b=g([]),f=g([]),d=P({name:"",dimensions:"",featuresText:"",characteristicsText:""}),v=P({name:!0,dimensions:!0,features:!0,characteristics:!0}),r=P({scene:[...U.scene],angle:[...U.angle],style:[...U.style],target:[...U.target]}),c=P({scene:[],angle:[],style:[],target:[]}),u=P({category:"",index:-1}),x=g(!1),j=g(""),A=g(""),D=g([]),oe=Z(()=>Math.ceil(ne.value/Y)),S=Z(()=>{const n=[];if(V.value){if(v.name&&d.name&&n.push(d.name),v.dimensions&&d.dimensions&&n.push(d.dimensions),v.features&&d.featuresText){const e=d.featuresText.split(`
`).filter(s=>s.trim());e.length>0&&n.push(e.join("、"))}if(v.characteristics&&d.characteristicsText){const e=d.characteristicsText.split(`
`).filter(s=>s.trim());e.length>0&&n.push(e.join("、"))}}if(c.scene.length>0&&n.push(c.scene.join("、")),c.angle.length>0&&n.push(c.angle.join("、")),c.style.length>0&&n.push(c.style.join("、")),c.target.length>0){const e=c.target.map(s=>s==="主图"?"电商主图风格":s==="详情页"?"详情页展示风格":s==="海报"?"促销海报风格":s==="白底图"?"纯白背景产品图":s==="场景图"?"场景化展示":s);n.push(e.join("、"))}return n.join("，")}),ie=Z(()=>V.value&&f.value.length>0&&S.value.length>0),ve=Z(()=>V.value?f.value.length===0?"请选择至少一张参考图片":S.value?"":"请选择模板选项或填写产品信息":"请先选择一个产品");function ge(){const n=document.cookie.match(/csrf_token=([^;]+)/);return n?n[1]:""}function me(n){return String(n||"").trim().replace(/^bearer\s+/i,"").trim()}function he(n){return String(n||"").trim()||null}function de(n){if(!n||typeof n!="object")return null;if(Array.isArray(n.data)&&n.data[0]){const e=n.data[0];if(e!=null&&e.url)return e.url;if(e!=null&&e.b64_json)return`data:image/png;base64,${e.b64_json}`}return n.url?n.url:n.b64_json?`data:image/png;base64,${n.b64_json}`:n.image_url?n.image_url:null}async function F(){L.value=!0;try{const n=new URLSearchParams({offset:String((w.value-1)*Y),limit:String(Y)});R.value&&n.set("name",R.value);const e=await fetch(`/api/v1/products?${n}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch products");const s=await e.json();E.value=s.products||[],ne.value=s.total||0}catch{T("加载产品列表失败","error")}finally{L.value=!1}}function fe(){w.value=1,F()}function ye(){w.value>1&&(w.value--,F())}function ke(){w.value<oe.value&&(w.value++,F())}function be(n){if(n.images&&n.images.length>0){const e=n.images.find(s=>s.is_primary);return e?e.image_url:n.images[0].image_url}return n.original_image_url||"/static/placeholder.png"}async function we(n){V.value=n;try{const e=await fetch(`/api/v1/products/${n.id}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to load product details");const s=await e.json();d.name=s.name||"",d.dimensions=s.dimensions||"",d.featuresText=(s.features||[]).join(`
`),d.characteristicsText=(s.characteristics||[]).join(`
`),b.value=s.images||[],b.value.length===0&&s.original_image_url&&(b.value=[{id:s.id,image_url:s.original_image_url,is_primary:!0}]);const o=b.value.find(a=>a.is_primary);o?f.value=[o.id]:b.value.length>0?f.value=[b.value[0].id]:f.value=[]}catch{T("加载产品详情失败","error")}}function xe(n){const e=f.value.indexOf(n);e===-1?f.value.push(n):f.value.splice(e,1)}function N(n,e){const s=c[n],o=s.indexOf(e);o===-1?s.push(e):s.splice(o,1),q()}function J(n){r[n].push("新选项"),q(),je(()=>{H(n,r[n].length-1)})}function X(n,e){const s=r[n][e];r[n].splice(e,1);const o=c[n].indexOf(s);o!==-1&&c[n].splice(o,1),q()}function H(n,e){u.category=n,u.index=e}function M(){u.category="",u.index=-1,q()}function Ce(){r.scene=[...U.scene],r.angle=[...U.angle],r.style=[...U.style],r.target=[...U.target],c.scene=[],c.angle=[],c.style=[],c.target=[],localStorage.removeItem("ecommerce-image-templates"),T("模板已重置为默认值","success")}function q(){localStorage.setItem("ecommerce-image-templates",JSON.stringify(r))}function _e(){const n=localStorage.getItem("ecommerce-image-templates");if(n)try{const e=JSON.parse(n);e.scene&&(r.scene=e.scene),e.angle&&(r.angle=e.angle),e.style&&(r.style=e.style),e.target&&(r.target=e.target)}catch{}}function Be(){localStorage.setItem("ecommerce-image-api-config",JSON.stringify(y)),T("API 配置已保存","success")}function Ue(){y.apiKey="",y.baseUrl="",localStorage.removeItem("ecommerce-image-api-config"),T("API 配置已重置","success")}function Se(){const n=localStorage.getItem("ecommerce-image-api-config");if(n)try{const e=JSON.parse(n);e.apiKey&&(y.apiKey=e.apiKey),e.baseUrl&&(y.baseUrl=e.baseUrl)}catch{}}async function Me(){if(S.value)try{await navigator.clipboard.writeText(S.value),T("Prompt 已复制到剪贴板","success")}catch{T("复制失败","error")}}async function ue(){if(!(!ie.value||x.value)){x.value=!0,A.value="";try{const n=new FormData;n.append("prompt",S.value),n.append("model",k.model),n.append("response_format","url"),k.aspectRatio&&n.append("aspect_ratio",k.aspectRatio),k.imageSize&&n.append("image_size",k.imageSize);for(const G of f.value){const le=b.value.find(ae=>ae.id===G);if(le)try{const $e=await(await fetch(le.image_url)).blob();n.append("image",$e,`ref-${G}.jpg`)}catch{console.warn("Failed to fetch reference image:",le.image_url)}}const e={"X-CSRF-Token":ge()},s=me(y.apiKey);s&&(e["X-API-Key"]=s);const o=he(y.baseUrl);o&&(e["X-Base-Url"]=o);const a=await fetch("/api/v1/images/edits",{method:"POST",credentials:"include",headers:e,body:n});if(!a.ok){const G=await a.json().catch(()=>({}));throw new Error(G.detail||`HTTP ${a.status}`)}const z=await a.json(),Pe=z&&typeof z=="object"&&z.response?z.response:z,ce=de(Pe)||de(z);if(ce)j.value=ce;else throw new Error("Invalid response format");T("图片生成成功","success")}catch(n){A.value=n.message||"生成失败，请重试"}finally{x.value=!1}}}function Te(){if(!j.value)return;const n=document.createElement("a");n.href=j.value,n.download=`ecommerce-${Date.now()}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}let Ve=0;function T(n,e="info"){const s=Ve++;D.value.push({id:s,message:n,type:e}),setTimeout(()=>{const o=D.value.findIndex(a=>a.id===s);o!==-1&&D.value.splice(o,1)},3e3)}return Ke(()=>{_e(),Se(),F()}),(n,e)=>(l(),i("div",ze,[t("header",Oe,[e[26]||(e[26]=O('<div class="logo"><div class="logo-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg></div><span>电商图生成</span></div>',1)),t("div",He,[e[25]||(e[25]=t("a",{href:"/",class:"btn btn-secondary",style:{"text-decoration":"none",display:"flex","align-items":"center",gap:"8px"}},[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M19 12H5M12 19l-7-7 7-7"})]),C(" 返回主页面 ")],-1)),t("button",{class:"btn btn-ghost btn-icon",onClick:e[0]||(e[0]=s=>ee.value=!ee.value),title:"Settings"},[...e[24]||(e[24]=[t("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"12",cy:"12",r:"3"}),t("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})],-1)])])])]),t("div",Ee,[t("aside",Le,[ee.value?(l(),i("section",Re,[e[31]||(e[31]=t("div",{class:"section-title"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),t("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4"})]),C(" API Configuration ")],-1)),t("div",De,[e[28]||(e[28]=t("label",{class:"form-label"},"API Key",-1)),t("div",Fe,[p(t("input",{type:te.value?"text":"password",class:"form-input","onUpdate:modelValue":e[1]||(e[1]=s=>y.apiKey=s),placeholder:"Enter your API key"},null,8,Ne),[[pe,y.apiKey]]),t("button",{class:"toggle-visibility",onClick:e[2]||(e[2]=s=>te.value=!te.value)},[...e[27]||(e[27]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t("circle",{cx:"12",cy:"12",r:"3"})],-1)])])])]),t("div",Je,[e[30]||(e[30]=t("label",{class:"form-label"},"Base URL",-1)),t("div",Xe,[p(t("input",{type:se.value?"text":"password",class:"form-input","onUpdate:modelValue":e[3]||(e[3]=s=>y.baseUrl=s),placeholder:"https://api.example.com"},null,8,qe),[[pe,y.baseUrl]]),t("button",{class:"toggle-visibility",onClick:e[4]||(e[4]=s=>se.value=!se.value)},[...e[29]||(e[29]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t("circle",{cx:"12",cy:"12",r:"3"})],-1)])])])]),t("div",{class:"btn-group"},[t("button",{class:"btn btn-primary btn-sm",onClick:Be},"Save"),t("button",{class:"btn btn-secondary btn-sm",onClick:Ue},"Reset")])])):m("",!0),t("section",Ge,[e[37]||(e[37]=O('<div class="section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg> Model Selection </div>',1)),p(t("select",{class:"form-select","onUpdate:modelValue":e[5]||(e[5]=s=>k.model=s)},[...e[32]||(e[32]=[O('<option value="gpt-image-1.5">gpt-image-1.5</option><option value="nano-banana-2-4k">nano-banana-2-4k</option><option value="nano-banana-2-2k">nano-banana-2-2k</option><option value="nano-banana-2">nano-banana-2</option><option value="nano-banana">nano-banana</option>',5)])],512),[[re,k.model]]),t("div",Ze,[e[34]||(e[34]=t("label",{class:"form-label"},"Aspect Ratio",-1)),p(t("select",{class:"form-select","onUpdate:modelValue":e[6]||(e[6]=s=>k.aspectRatio=s)},[...e[33]||(e[33]=[O('<option value="">Auto</option><option value="1:1">1:1 (Square)</option><option value="16:9">16:9 (Landscape)</option><option value="9:16">9:16 (Portrait)</option><option value="4:3">4:3</option><option value="3:4">3:4</option><option value="3:2">3:2</option><option value="2:3">2:3</option><option value="4:5">4:5</option><option value="5:4">5:4</option>',10)])],512),[[re,k.aspectRatio]])]),t("div",Qe,[e[36]||(e[36]=t("label",{class:"form-label"},"Image Size",-1)),p(t("select",{class:"form-select","onUpdate:modelValue":e[7]||(e[7]=s=>k.imageSize=s)},[...e[35]||(e[35]=[t("option",{value:""},"Default",-1),t("option",{value:"1K"},"1K",-1),t("option",{value:"2K"},"2K",-1),t("option",{value:"4K"},"4K",-1)])],512),[[re,k.imageSize]])])]),t("section",We,[e[43]||(e[43]=O('<div class="section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2Z"></path><path d="M9 2v5"></path><path d="M15 2v5"></path><path d="M2 9h20"></path></svg> 选择产品 </div>',1)),t("div",Ye,[e[38]||(e[38]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),p(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[8]||(e[8]=s=>R.value=s),placeholder:"搜索产品...",onInput:fe},null,544),[[_,R.value]])]),!L.value&&E.value.length>0?(l(),i("div",et,[(l(!0),i($,null,I(E.value,s=>{var o;return l(),i("div",{key:s.id,class:K(["product-item",{selected:((o=V.value)==null?void 0:o.id)===s.id}]),onClick:a=>we(s)},[t("img",{src:be(s),alt:s.name,class:"product-thumb"},null,8,st),t("div",nt,[t("div",ot,h(s.name||"未命名产品"),1),t("div",it,h(s.dimensions||""),1)])],10,tt)}),128))])):!L.value&&E.value.length===0?(l(),i("div",lt,[...e[39]||(e[39]=[t("p",null,"暂无产品",-1),t("a",{href:"/products",class:"btn btn-secondary btn-sm"},"前往产品库",-1)])])):(l(),i("div",at,[...e[40]||(e[40]=[t("div",{class:"spinner-small"},null,-1),t("span",null,"加载中...",-1)])])),ne.value>Y?(l(),i("div",rt,[t("button",{class:"btn btn-ghost btn-sm",disabled:w.value<=1,onClick:ye},[...e[41]||(e[41]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])],8,dt),t("span",ut,h(w.value)+" / "+h(oe.value),1),t("button",{class:"btn btn-ghost btn-sm",disabled:w.value>=oe.value,onClick:ke},[...e[42]||(e[42]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])],8,ct)])):m("",!0)]),V.value?(l(),i("section",pt,[t("div",vt,[e[44]||(e[44]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t("polyline",{points:"21 15 16 10 5 21"})],-1)),C(" 参考图片 ("+h(f.value.length)+"/"+h(b.value.length)+") ",1)]),b.value.length>0?(l(),i("div",gt,[(l(!0),i($,null,I(b.value,s=>(l(),i("div",{key:s.id,class:K(["image-item",{selected:f.value.includes(s.id)}]),onClick:o=>xe(s.id)},[t("img",{src:s.image_url,alt:"Product image"},null,8,ht),f.value.includes(s.id)?(l(),i("div",ft,[...e[45]||(e[45]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"3"},[t("polyline",{points:"20 6 9 17 4 12"})],-1)])])):m("",!0),s.is_primary?(l(),i("div",yt,"主图")):m("",!0)],10,mt))),128))])):(l(),i("div",kt,[...e[46]||(e[46]=[t("p",null,"该产品暂无图片",-1)])]))])):m("",!0)]),t("main",bt,[V.value?(l(),i("div",wt,[e[51]||(e[51]=t("div",{class:"panel-header"},[t("h3",null,"产品信息"),t("span",{class:"panel-hint"},"勾选要包含在 Prompt 中的字段")],-1)),t("div",xt,[t("div",Ct,[t("label",_t,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=s=>v.name=s)},null,512),[[Q,v.name]]),e[47]||(e[47]=t("span",null,"产品名称",-1))]),p(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[10]||(e[10]=s=>d.name=s),disabled:!v.name},null,8,Bt),[[_,d.name]])]),t("div",Ut,[t("label",St,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=s=>v.dimensions=s)},null,512),[[Q,v.dimensions]]),e[48]||(e[48]=t("span",null,"尺寸规格",-1))]),p(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[12]||(e[12]=s=>d.dimensions=s),disabled:!v.dimensions},null,8,Mt),[[_,d.dimensions]])]),t("div",Tt,[t("label",Vt,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=s=>v.features=s)},null,512),[[Q,v.features]]),e[49]||(e[49]=t("span",null,"功能特征",-1))]),p(t("textarea",{class:"form-input","onUpdate:modelValue":e[14]||(e[14]=s=>d.featuresText=s),disabled:!v.features,rows:"2",placeholder:"每行一个特征"},null,8,Pt),[[_,d.featuresText]])]),t("div",$t,[t("label",It,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[15]||(e[15]=s=>v.characteristics=s)},null,512),[[Q,v.characteristics]]),e[50]||(e[50]=t("span",null,"产品特点",-1))]),p(t("textarea",{class:"form-input","onUpdate:modelValue":e[16]||(e[16]=s=>d.characteristicsText=s),disabled:!v.characteristics,rows:"2",placeholder:"每行一个特点"},null,8,Kt),[[_,d.characteristicsText]])])])])):m("",!0),t("div",jt,[t("div",{class:"panel-header"},[e[53]||(e[53]=t("h3",null,"Prompt 模板",-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:Ce},[...e[52]||(e[52]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),C(" 重置默认 ",-1)])])]),t("div",At,[t("div",zt,[e[55]||(e[55]=t("span",{class:"module-title"},"场景选择",-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[17]||(e[17]=s=>J("scene"))},[...e[54]||(e[54]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",Ot,[(l(!0),i($,null,I(r.scene,(s,o)=>(l(),i("div",{key:"scene-"+o,class:K(["option-chip",{selected:c.scene.includes(s)}])},[u.category!=="scene"||u.index!==o?(l(),i("span",{key:0,onClick:a=>N("scene",s)},h(s),9,Ht)):p((l(),i("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":a=>r.scene[o]=a,onBlur:M,onKeyup:W(M,["enter"]),ref_for:!0,ref:"optionInput"},null,40,Et)),[[_,r.scene[o]]]),u.category!=="scene"||u.index!==o?(l(),i("button",{key:2,class:"chip-edit",onClick:B(a=>H("scene",o),["stop"])},[...e[56]||(e[56]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Lt)):m("",!0),t("button",{class:"chip-delete",onClick:B(a=>X("scene",o),["stop"])},[...e[57]||(e[57]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,Rt)],2))),128))])]),t("div",Dt,[t("div",Ft,[e[59]||(e[59]=t("span",{class:"module-title"},"拍摄角度",-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[18]||(e[18]=s=>J("angle"))},[...e[58]||(e[58]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",Nt,[(l(!0),i($,null,I(r.angle,(s,o)=>(l(),i("div",{key:"angle-"+o,class:K(["option-chip",{selected:c.angle.includes(s)}])},[u.category!=="angle"||u.index!==o?(l(),i("span",{key:0,onClick:a=>N("angle",s)},h(s),9,Jt)):p((l(),i("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":a=>r.angle[o]=a,onBlur:M,onKeyup:W(M,["enter"])},null,40,Xt)),[[_,r.angle[o]]]),u.category!=="angle"||u.index!==o?(l(),i("button",{key:2,class:"chip-edit",onClick:B(a=>H("angle",o),["stop"])},[...e[60]||(e[60]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,qt)):m("",!0),t("button",{class:"chip-delete",onClick:B(a=>X("angle",o),["stop"])},[...e[61]||(e[61]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,Gt)],2))),128))])]),t("div",Zt,[t("div",Qt,[e[63]||(e[63]=t("span",{class:"module-title"},[C("风格 / 光影 "),t("span",{class:"optional-tag"},"(可选)")],-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[19]||(e[19]=s=>J("style"))},[...e[62]||(e[62]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",Wt,[(l(!0),i($,null,I(r.style,(s,o)=>(l(),i("div",{key:"style-"+o,class:K(["option-chip",{selected:c.style.includes(s)}])},[u.category!=="style"||u.index!==o?(l(),i("span",{key:0,onClick:a=>N("style",s)},h(s),9,Yt)):p((l(),i("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":a=>r.style[o]=a,onBlur:M,onKeyup:W(M,["enter"])},null,40,es)),[[_,r.style[o]]]),u.category!=="style"||u.index!==o?(l(),i("button",{key:2,class:"chip-edit",onClick:B(a=>H("style",o),["stop"])},[...e[64]||(e[64]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,ts)):m("",!0),t("button",{class:"chip-delete",onClick:B(a=>X("style",o),["stop"])},[...e[65]||(e[65]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,ss)],2))),128))])]),t("div",ns,[t("div",os,[e[67]||(e[67]=t("span",{class:"module-title"},"生成目标",-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[20]||(e[20]=s=>J("target"))},[...e[66]||(e[66]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",is,[(l(!0),i($,null,I(r.target,(s,o)=>(l(),i("div",{key:"target-"+o,class:K(["option-chip",{selected:c.target.includes(s)}])},[u.category!=="target"||u.index!==o?(l(),i("span",{key:0,onClick:a=>N("target",s)},h(s),9,ls)):p((l(),i("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":a=>r.target[o]=a,onBlur:M,onKeyup:W(M,["enter"])},null,40,as)),[[_,r.target[o]]]),u.category!=="target"||u.index!==o?(l(),i("button",{key:2,class:"chip-edit",onClick:B(a=>H("target",o),["stop"])},[...e[68]||(e[68]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,rs)):m("",!0),t("button",{class:"chip-delete",onClick:B(a=>X("target",o),["stop"])},[...e[69]||(e[69]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,ds)],2))),128))])])]),t("div",us,[t("div",cs,[e[71]||(e[71]=t("h3",null,"Prompt 预览",-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:Me,disabled:!S.value},[...e[70]||(e[70]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),C(" 复制 ",-1)])],8,ps)]),t("div",vs,[S.value?(l(),i("p",gs,h(S.value),1)):(l(),i("p",ms,"选择产品和模板选项后，Prompt 将在此显示..."))])]),t("div",hs,[!x.value&&!j.value?(l(),i("div",fs,[...e[72]||(e[72]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t("polyline",{points:"21 15 16 10 5 21"})],-1),t("h3",null,"准备生成",-1),t("p",null,"选择产品、参考图片和模板选项，然后点击生成",-1)])])):m("",!0),x.value?(l(),i("div",ys,[...e[73]||(e[73]=[t("div",{class:"spinner"},null,-1),t("p",null,"正在生成图片...",-1)])])):m("",!0),j.value&&!x.value?(l(),i("div",ks,[t("img",{src:j.value,alt:"Generated image",class:"result-image"},null,8,bs),t("div",{class:"result-actions"},[t("button",{class:"btn btn-secondary",onClick:Te},[...e[74]||(e[74]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t("polyline",{points:"7 10 12 15 17 10"}),t("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1),C(" 下载 ",-1)])]),t("button",{class:"btn btn-primary",onClick:ue},[...e[75]||(e[75]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),C(" 重新生成 ",-1)])])])])):m("",!0)]),t("div",ws,[t("button",{class:"generate-btn",disabled:!ie.value||x.value,onClick:ue},[x.value?(l(),i("div",_s)):(l(),i("svg",Cs,[...e[76]||(e[76]=[t("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},null,-1)])])),C(" "+h(x.value?"生成中...":"生成电商图"),1)],8,xs),ie.value?m("",!0):(l(),i("div",Bs,h(ve.value),1))])])]),t("div",Us,[(l(!0),i($,null,I(D.value,s=>(l(),i("div",{key:s.id,class:K(["toast",s.type])},h(s.message),3))),128))]),A.value?(l(),i("div",{key:0,class:"error-overlay",onClick:e[23]||(e[23]=s=>A.value="")},[t("div",{class:"error-modal",onClick:e[22]||(e[22]=B(()=>{},["stop"]))},[e[77]||(e[77]=O('<div class="error-header"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg><h3>生成失败</h3></div>',1)),t("p",null,h(A.value),1),t("button",{class:"btn btn-primary",onClick:e[21]||(e[21]=s=>A.value="")},"确定")])])):m("",!0)]))}});Ae(Ss).mount("#app");
