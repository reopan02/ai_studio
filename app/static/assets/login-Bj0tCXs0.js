import{d as v,r as n,a as f,b as w,e as t,w as d,k as p,l as g,n as h,t as y,i as m,j as _}from"./runtime-dom.esm-bundler-BI5Nxju0.js";import{r as x}from"./http-BvltrcKL.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                   */function k(){const a=new URL(window.location.href).searchParams.get("next")||"/";return!a.startsWith("/")||a.includes("://")||a.startsWith("//")?"/":a}const E={class:"container"},O={class:"card auth-card"},T={class:"form-group"},P={class:"form-group"},B={class:"auth-actions"},C=["disabled"],N={id:"error",class:"auth-error",role:"alert","aria-live":"polite"},S=v({__name:"login-page",setup(c){const a=n(""),s=n(""),o=n(""),r=n(!1);async function u(){o.value="";const l=a.value.trim();if(!l||!s.value){o.value="请输入用户名/邮箱和密码";return}r.value=!0;try{const e=await fetch("/api/v1/auth/login?set_cookie=1",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username_or_email:l,password:s.value})});if(!e.ok)throw new Error(await x(e));window.location.href=k()}catch(e){o.value=(e==null?void 0:e.message)||"登录失败"}finally{r.value=!1}}return(l,e)=>(w(),f("div",E,[t("main",null,[t("section",O,[e[6]||(e[6]=t("h2",null,"登录",-1)),t("div",T,[e[2]||(e[2]=t("label",{for:"usernameOrEmail"},"用户名或邮箱",-1)),d(t("input",{id:"usernameOrEmail","onUpdate:modelValue":e[0]||(e[0]=i=>a.value=i),type:"text",autocomplete:"username",placeholder:"输入用户名或邮箱"},null,512),[[p,a.value]])]),t("div",P,[e[3]||(e[3]=t("label",{for:"password"},"密码",-1)),d(t("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=i=>s.value=i),type:"password",autocomplete:"current-password",placeholder:"输入密码",onKeydown:g(u,["enter"])},null,544),[[p,s.value]])]),t("div",B,[t("button",{id:"loginBtn",class:h(["primary-btn",{loading:r.value}]),type:"button",disabled:r.value,onClick:u},[...e[4]||(e[4]=[t("span",{class:"btn-text"},"登录",-1),t("span",{class:"loader"},null,-1)])],10,C),e[5]||(e[5]=t("a",{class:"meta-text",href:"/",style:{"text-decoration":"none"}},"返回首页",-1))]),t("div",N,y(o.value),1),e[7]||(e[7]=t("div",{class:"auth-meta"},[m(" 没有账号？请使用 "),t("code",null,"POST /api/v1/auth/register"),m(" 注册后再登录。 ")],-1))])])]))}}),V=b(S,[["__scopeId","data-v-668fe191"]]);_(V).mount("#app");
