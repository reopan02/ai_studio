import{d as Ge,m as E,r as y,c as I,o as Je,a as n,b as i,i as N,e as t,f as p,w as v,s as ge,k as S,F as f,q as b,n as C,t as r,h as V,u as oe,l as ae,p as k,x as Ze,j as Qe}from"./runtime-dom.esm-bundler-CJCwMzH0.js";/* empty css                        */const We={class:"ecommerce-image-page"},Ye={class:"main-container"},et={class:"sidebar"},tt={class:"sidebar-section"},st={class:"form-group",style:{"margin-top":"16px"}},lt={class:"form-group"},nt={class:"sidebar-section"},it={class:"search-wrapper"},ot={key:0,class:"product-list"},at=["onClick"],rt=["src","alt"],dt={class:"product-info"},ct={class:"product-name"},ut={class:"product-meta"},pt={key:1,class:"product-list-empty"},vt={key:2,class:"product-list-loading"},mt={key:3,class:"pagination"},gt=["disabled"],ht={class:"page-info"},yt=["disabled"],ft={key:0,class:"sidebar-section"},bt={class:"section-title"},kt={key:0,class:"image-grid"},wt=["onClick"],xt=["src"],_t={key:0,class:"image-check"},Ct={key:1,class:"image-primary"},Tt={key:1,class:"no-images"},Bt={class:"main-content"},$t={class:"workflow-section"},St={class:"content-panel"},Vt={class:"panel-header"},Ut={key:0,class:"panel-hint"},Mt={key:0,class:"product-fields"},It={class:"field-row"},Pt={class:"field-checkbox"},Kt=["disabled"],jt={class:"field-row"},Lt={class:"field-checkbox"},zt=["disabled"],Ot={class:"field-row"},Et={class:"field-checkbox"},At=["disabled"],Dt={class:"field-row"},Rt={class:"field-checkbox"},Ht=["disabled"],Ft={key:1,class:"panel-empty"},Nt={class:"workflow-section"},qt={class:"content-panel"},Xt={class:"template-modules"},Gt={class:"template-module"},Jt={class:"module-header"},Zt={class:"option-chips"},Qt=["onClick"],Wt=["onUpdate:modelValue","data-option-id","onKeydown"],Yt=["onClick"],es=["onClick"],ts={class:"template-module"},ss={class:"module-header"},ls={class:"option-chips"},ns=["onClick"],is=["onUpdate:modelValue","data-option-id","onKeydown"],os=["onClick"],as=["onClick"],rs={class:"template-module"},ds={class:"module-header"},cs={class:"option-chips"},us=["onClick"],ps=["onUpdate:modelValue","data-option-id","onKeydown"],vs=["onClick"],ms=["onClick"],gs={class:"template-module"},hs={class:"module-header"},ys={class:"option-chips"},fs=["onClick"],bs=["onUpdate:modelValue","data-option-id","onKeydown"],ks=["onClick"],ws=["onClick"],xs={class:"template-editor"},_s={class:"template-editor-section"},Cs={class:"variable-reference"},Ts={class:"variable-chips"},Bs=["onClick","title"],$s=["textContent"],Ss={key:0,class:"variable-value"},Vs={class:"workflow-section"},Us={class:"content-panel prompt-preview-panel"},Ms={class:"panel-header"},Is={key:0,class:"panel-hint"},Ps={class:"prompt-structured"},Ks={class:"prompt-row"},js={key:1,class:"prompt-empty"},Ls={class:"prompt-row"},zs={key:1,class:"prompt-empty"},Os={class:"prompt-row"},Es={key:1,class:"prompt-empty"},As={class:"prompt-row"},Ds={key:1,class:"prompt-empty"},Rs={class:"prompt-row"},Hs={key:1,class:"prompt-empty"},Fs={class:"prompt-full"},Ns={class:"prompt-full-header"},qs=["disabled"],Xs={class:"prompt-full-body"},Gs={key:0},Js={key:1,class:"prompt-placeholder"},Zs={class:"workflow-section"},Qs={class:"content-panel"},Ws={class:"panel-header"},Ys={key:0,class:"panel-hint"},el={class:"result-area"},tl={key:0,class:"result-placeholder"},sl={key:1,class:"loading-state"},ll={key:2,class:"result-container"},nl=["src"],il={class:"generate-section"},ol=["disabled"],al={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},rl={key:1,class:"spinner-small"},dl={key:0,class:"generate-hint"},cl={class:"toast-container"},xe="{{product_name}}{{dimensions|}}，{{features|}}{{characteristics|}}，{{scene|}}，{{angle|}}，{{style|}}，{{target|}}，高清产品摄影",re=10,ul=Ge({__name:"ecommerce-image-page",setup(pl){const P={scene:[{id:"scene-white",label:"白色背景"},{id:"scene-natural-table",label:"自然光桌面"},{id:"scene-outdoor",label:"户外场景"},{id:"scene-solid",label:"纯色背景"},{id:"scene-life",label:"生活场景"}],angle:[{id:"angle-front",label:"正面"},{id:"angle-45",label:"45度侧面"},{id:"angle-top",label:"俯视"},{id:"angle-eye",label:"平视"},{id:"angle-close",label:"特写"}],style:[{id:"style-soft",label:"柔和光影"},{id:"style-contrast",label:"高对比度"},{id:"style-natural",label:"自然光"},{id:"style-studio",label:"专业棚拍"},{id:"style-warm",label:"暖色调"}],target:[{id:"target-main",label:"主图"},{id:"target-detail",label:"详情页"},{id:"target-poster",label:"海报"},{id:"target-white",label:"白底图"},{id:"target-scene",label:"场景图"}]},q=E({apiKey:"",baseUrl:""}),T=E({model:"gemini-3-pro-image-preview",aspectRatio:"",imageSize:"1K"}),X=y([]),G=y(!1),J=y(""),U=y(1),de=y(0),K=y(null),B=y([]),w=y([]),c=E({name:"",dimensions:"",featuresText:"",characteristicsText:""}),u=E({name:!0,dimensions:!0,features:!0,characteristics:!0}),d=E({scene:P.scene.map(l=>({...l})),angle:P.angle.map(l=>({...l})),style:P.style.map(l=>({...l})),target:P.target.map(l=>({...l}))}),x=E({scene:[],angle:[],style:[],target:[]}),m=E({category:"",id:""}),z=y(xe),$=y(!1),A=y(""),D=y(""),Z=y([]),ce=I(()=>Math.ceil(de.value/re));function ue(l){return globalThis.crypto&&"randomUUID"in globalThis.crypto?`${l}-${globalThis.crypto.randomUUID()}`:`${l}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function Q(l){return l.split(`
`).map(e=>e.trim()).filter(Boolean)}function R(l){return l.filter(Boolean).join("、")}function W(l){const e=new Set(x[l]);return d[l].filter(s=>e.has(s.id)).map(s=>s.label.trim()).filter(Boolean)}function _(l,e){return m.category===l&&m.id===e}const j=I(()=>({scene:W("scene"),angle:W("angle"),style:W("style"),target:W("target")})),_e=I(()=>{const l=[],e=c.name.trim(),s=c.dimensions.trim();return u.name&&e&&l.push(e),u.dimensions&&s&&l.push(s),u.features&&l.push(...Q(c.featuresText)),u.characteristics&&l.push(...Q(c.characteristicsText)),l}),g=I(()=>({product:_e.value,scene:j.value.scene,angle:j.value.angle,style:j.value.style,target:j.value.target})),he=I(()=>{const l=u.features?Q(c.featuresText):[],e=u.characteristics?Q(c.characteristicsText):[];return{product_name:u.name?c.name.trim():"",dimensions:u.dimensions?c.dimensions.trim():"",features:R(l),characteristics:R(e),scene:R(j.value.scene),angle:R(j.value.angle),style:R(j.value.style),target:R(j.value.target)}}),Ce=I(()=>{const l=he.value;return[{name:"product_name",description:"产品名称",currentValue:l.product_name},{name:"dimensions",description:"尺寸规格",currentValue:l.dimensions},{name:"features",description:"功能特征（以、分隔）",currentValue:l.features},{name:"characteristics",description:"产品特点（以、分隔）",currentValue:l.characteristics},{name:"scene",description:"场景选择",currentValue:l.scene},{name:"angle",description:"拍摄角度",currentValue:l.angle},{name:"style",description:"风格/光影",currentValue:l.style},{name:"target",description:"生成目标",currentValue:l.target}]});function Te(l,e){return l.replace(/\{\{(\w+)(?:\|([^}]*))?\}\}/g,(s,o,a)=>{const h=e[o];return h&&h.trim()?h:a!==void 0?a:""}).replace(/[，、]{2,}/g,"，").replace(/^[，、\s]+/,"").replace(/[，、\s]+$/,"").replace(/\s*[，、]\s*/g,"，")}const M=I(()=>K.value?Te(z.value,he.value):""),ye=I(()=>K.value&&w.value.length>0&&M.value.length>0),Y=I(()=>$.value?"正在生成图片...":K.value?w.value.length===0?"请选择至少一张参考图片":M.value?"":"请完善模板选项或产品信息":"请先在左侧选择产品");function Be(){const l=document.cookie.match(/csrf_token=([^;]+)/);return l?l[1]:""}function $e(l){return String(l||"").trim().replace(/^bearer\s+/i,"").trim()}function Se(l){return String(l||"").trim()||null}function fe(l){if(!l||typeof l!="object")return null;if(Array.isArray(l.data)&&l.data[0]){const e=l.data[0];if(e!=null&&e.url)return e.url;if(e!=null&&e.b64_json)return`data:image/png;base64,${e.b64_json}`}return l.url?l.url:l.b64_json?`data:image/png;base64,${l.b64_json}`:l.image_url?l.image_url:null}async function ee(){G.value=!0;try{const l=new URLSearchParams({offset:String((U.value-1)*re),limit:String(re)});J.value&&l.set("name",J.value);const e=await fetch(`/api/v1/products?${l}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch products");const s=await e.json();X.value=s.products||[],de.value=s.total||0}catch{O("加载产品列表失败","error")}finally{G.value=!1}}function Ve(){U.value=1,ee()}function Ue(){U.value>1&&(U.value--,ee())}function Me(){U.value<ce.value&&(U.value++,ee())}function Ie(l){if(l.images&&l.images.length>0){const e=l.images.find(s=>s.is_primary);return e?e.image_url:l.images[0].image_url}return l.original_image_url||"/static/placeholder.png"}async function Pe(l){K.value=l;try{const e=await fetch(`/api/v1/products/${l.id}`,{credentials:"include"});if(!e.ok)throw new Error("Failed to load product details");const s=await e.json();c.name=s.name||"",c.dimensions=s.dimensions||"",c.featuresText=(s.features||[]).join(`
`),c.characteristicsText=(s.characteristics||[]).join(`
`),B.value=s.images||[],B.value.length===0&&s.original_image_url&&(B.value=[{id:s.id,image_url:s.original_image_url,is_primary:!0}]);const o=B.value.find(a=>a.is_primary);o?w.value=[o.id]:B.value.length>0?w.value=[B.value[0].id]:w.value=[]}catch{O("加载产品详情失败","error")}}function Ke(l){const e=w.value.indexOf(l);e===-1?w.value.push(l):w.value.splice(e,1)}function je(l,e){return d[l].find(s=>s.id===e)??null}function Le(l){Ze(()=>{const e=document.querySelector(`.option-edit-input[data-option-id="${l}"]`);e&&(e.focus(),e.select())})}function te(l,e){const s=x[l],o=s.indexOf(e);o===-1?s.push(e):s.splice(o,1)}function se(l){const e={id:ue(l),label:"新选项"};d[l].push(e),pe(),F(l,e.id)}function H(l,e){const s=d[l].findIndex(a=>a.id===e);if(s===-1)return;d[l].splice(s,1);const o=x[l].indexOf(e);o!==-1&&x[l].splice(o,1),m.category===l&&m.id===e&&(m.category="",m.id=""),pe()}function F(l,e){m.category=l,m.id=e,Le(e)}function L(){if(!m.category||!m.id)return;const l=m.category,e=m.id;m.category="",m.id="";const s=je(l,e);if(!s)return;const o=s.label.trim();if(!o){H(l,e);return}s.label=o,pe()}function ze(){d.scene=P.scene.map(l=>({...l})),d.angle=P.angle.map(l=>({...l})),d.style=P.style.map(l=>({...l})),d.target=P.target.map(l=>({...l})),x.scene=[],x.angle=[],x.style=[],x.target=[],m.category="",m.id="",localStorage.removeItem("ecommerce-image-templates"),O("模板已重置为默认值","success")}function pe(){const l={version:2,templates:{scene:d.scene.map(e=>({id:e.id,label:e.label})),angle:d.angle.map(e=>({id:e.id,label:e.label})),style:d.style.map(e=>({id:e.id,label:e.label})),target:d.target.map(e=>({id:e.id,label:e.label}))}};localStorage.setItem("ecommerce-image-templates",JSON.stringify(l))}function le(l,e){if(!Array.isArray(l))return null;const s=[];for(const o of l){if(typeof o=="string"){const a=o.trim();a&&s.push({id:ue(e),label:a});continue}if(o&&typeof o=="object"){const a=typeof o.label=="string"?o.label.trim():"";if(!a)continue;const h=typeof o.id=="string"?String(o.id):ue(e);s.push({id:h,label:a})}}return s.length?s:null}function Oe(){const l=localStorage.getItem("ecommerce-image-templates");if(l)try{const e=JSON.parse(l),s=(e==null?void 0:e.templates)||e,o=le(s==null?void 0:s.scene,"scene"),a=le(s==null?void 0:s.angle,"angle"),h=le(s==null?void 0:s.style,"style"),ne=le(s==null?void 0:s.target,"target");o&&(d.scene=o),a&&(d.angle=a),h&&(d.style=h),ne&&(d.target=ne)}catch{}}function be(){localStorage.setItem("ecommerce-image-prompt-template",z.value)}function Ee(){const l=localStorage.getItem("ecommerce-image-prompt-template");l&&(z.value=l)}function Ae(){z.value=xe,localStorage.removeItem("ecommerce-image-prompt-template"),O("提示词模板已重置为默认值","success")}function De(l){z.value+=`{{${l}}}`,be()}function Re(l,e=20){return l?l.length<=e?l:l.substring(0,e)+"...":""}function He(){q.apiKey=localStorage.getItem("global_api_key")||localStorage.getItem("video_api_key")||"",q.baseUrl=localStorage.getItem("global_base_url")||localStorage.getItem("video_base_url")||""}async function Fe(){if(M.value)try{await navigator.clipboard.writeText(M.value),O("提示词已复制到剪贴板","success")}catch{O("复制失败","error")}}async function ke(){if(!(!ye.value||$.value)){$.value=!0,D.value="";try{const l=new FormData;l.append("prompt",M.value),l.append("model",T.model),l.append("response_format","url"),T.aspectRatio&&l.append("aspect_ratio",T.aspectRatio),T.imageSize&&l.append("image_size",T.imageSize);for(const ie of w.value){const ve=B.value.find(me=>me.id===ie);if(ve)try{const Xe=await(await fetch(ve.image_url)).blob();l.append("image",Xe,`ref-${ie}.jpg`)}catch{console.warn("Failed to fetch reference image:",ve.image_url)}}const e={"X-CSRF-Token":Be()},s=$e(q.apiKey);s&&(e["X-API-Key"]=s);const o=Se(q.baseUrl);o&&(e["X-Base-Url"]=o);const a=await fetch("/api/v1/images/edits",{method:"POST",credentials:"include",headers:e,body:l});if(!a.ok){const ie=await a.json().catch(()=>({}));throw new Error(ie.detail||`HTTP ${a.status}`)}const h=await a.json(),ne=h&&typeof h=="object"&&h.response?h.response:h,we=fe(ne)||fe(h);if(we)A.value=we;else throw new Error("Invalid response format");O("图片生成成功","success")}catch(l){D.value=l.message||"生成失败，请重试"}finally{$.value=!1}}}function Ne(){if(!A.value)return;const l=document.createElement("a");l.href=A.value,l.download=`ecommerce-${Date.now()}.png`,document.body.appendChild(l),l.click(),document.body.removeChild(l)}let qe=0;function O(l,e="info"){const s=qe++;Z.value.push({id:s,message:l,type:e}),setTimeout(()=>{const o=Z.value.findIndex(a=>a.id===s);o!==-1&&Z.value.splice(o,1)},3e3)}return Je(()=>{Oe(),Ee(),He(),ee()}),(l,e)=>(i(),n("div",We,[e[77]||(e[77]=N('<header class="header"><div class="logo"><div class="logo-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg></div><span>电商图生成</span></div><div class="header-actions"><a href="/" class="btn btn-secondary" style="text-decoration:none;display:flex;align-items:center;gap:8px;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg> 返回主页面 </a></div></header>',1)),t("div",Ye,[t("aside",et,[t("section",tt,[e[25]||(e[25]=N('<div class="section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg> Model Selection </div>',1)),v(t("select",{class:"form-select","onUpdate:modelValue":e[0]||(e[0]=s=>T.model=s)},[...e[20]||(e[20]=[t("option",{value:"gemini-3-pro-image-preview"},"gemini-3-pro-image-preview (推荐)",-1),t("option",{value:"gemini-2.5-flash-image"},"gemini-2.5-flash-image (快速)",-1)])],512),[[ge,T.model]]),t("div",st,[e[22]||(e[22]=t("label",{class:"form-label"},"Aspect Ratio",-1)),v(t("select",{class:"form-select","onUpdate:modelValue":e[1]||(e[1]=s=>T.aspectRatio=s)},[...e[21]||(e[21]=[N('<option value="">Auto</option><option value="1:1">1:1 (Square)</option><option value="16:9">16:9 (Landscape)</option><option value="9:16">9:16 (Portrait)</option><option value="4:3">4:3</option><option value="3:4">3:4</option><option value="3:2">3:2</option><option value="2:3">2:3</option><option value="4:5">4:5</option><option value="5:4">5:4</option>',10)])],512),[[ge,T.aspectRatio]])]),t("div",lt,[e[24]||(e[24]=t("label",{class:"form-label"},"Image Size",-1)),v(t("select",{class:"form-select","onUpdate:modelValue":e[2]||(e[2]=s=>T.imageSize=s)},[...e[23]||(e[23]=[t("option",{value:""},"Default",-1),t("option",{value:"1K"},"1K",-1),t("option",{value:"2K"},"2K",-1),t("option",{value:"4K"},"4K",-1)])],512),[[ge,T.imageSize]])])]),t("section",nt,[e[31]||(e[31]=N('<div class="section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2Z"></path><path d="M9 2v5"></path><path d="M15 2v5"></path><path d="M2 9h20"></path></svg> 选择产品 </div>',1)),t("div",it,[e[26]||(e[26]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),v(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[3]||(e[3]=s=>J.value=s),placeholder:"搜索产品...",onInput:Ve},null,544),[[S,J.value]])]),!G.value&&X.value.length>0?(i(),n("div",ot,[(i(!0),n(f,null,b(X.value,s=>{var o;return i(),n("div",{key:s.id,class:C(["product-item",{selected:((o=K.value)==null?void 0:o.id)===s.id}]),onClick:a=>Pe(s)},[t("img",{src:Ie(s),alt:s.name,class:"product-thumb"},null,8,rt),t("div",dt,[t("div",ct,r(s.name||"未命名产品"),1),t("div",ut,r(s.dimensions||""),1)])],10,at)}),128))])):!G.value&&X.value.length===0?(i(),n("div",pt,[...e[27]||(e[27]=[t("p",null,"暂无产品",-1),t("a",{href:"/products",class:"btn btn-secondary btn-sm"},"前往产品库",-1)])])):(i(),n("div",vt,[...e[28]||(e[28]=[t("div",{class:"spinner-small"},null,-1),t("span",null,"加载中...",-1)])])),de.value>re?(i(),n("div",mt,[t("button",{class:"btn btn-ghost btn-sm",disabled:U.value<=1,onClick:Ue},[...e[29]||(e[29]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])],8,gt),t("span",ht,r(U.value)+" / "+r(ce.value),1),t("button",{class:"btn btn-ghost btn-sm",disabled:U.value>=ce.value,onClick:Me},[...e[30]||(e[30]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])],8,yt)])):p("",!0)]),K.value?(i(),n("section",ft,[t("div",bt,[e[32]||(e[32]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t("polyline",{points:"21 15 16 10 5 21"})],-1)),V(" 参考图片 ("+r(w.value.length)+"/"+r(B.value.length)+") ",1)]),B.value.length>0?(i(),n("div",kt,[(i(!0),n(f,null,b(B.value,s=>(i(),n("div",{key:s.id,class:C(["image-item",{selected:w.value.includes(s.id)}]),onClick:o=>Ke(s.id)},[t("img",{src:s.image_url,alt:"Product image"},null,8,xt),w.value.includes(s.id)?(i(),n("div",_t,[...e[33]||(e[33]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"3"},[t("polyline",{points:"20 6 9 17 4 12"})],-1)])])):p("",!0),s.is_primary?(i(),n("div",Ct,"主图")):p("",!0)],10,wt))),128))])):(i(),n("div",Tt,[...e[34]||(e[34]=[t("p",null,"该产品暂无图片",-1)])]))])):p("",!0)]),t("main",Bt,[t("section",$t,[t("div",St,[t("div",Vt,[e[35]||(e[35]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"1"),t("div",null,[t("h3",null,"产品信息"),t("p",{class:"panel-subtitle"},"勾选要包含在提示词中的字段")])],-1)),K.value?p("",!0):(i(),n("span",Ut,"请先从左侧选择产品"))]),K.value?(i(),n("div",Mt,[t("div",It,[t("label",Pt,[v(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=s=>u.name=s)},null,512),[[oe,u.name]]),e[36]||(e[36]=t("span",null,"产品名称",-1))]),v(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[5]||(e[5]=s=>c.name=s),disabled:!u.name,placeholder:"例如：保温杯"},null,8,Kt),[[S,c.name]])]),t("div",jt,[t("label",Lt,[v(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>u.dimensions=s)},null,512),[[oe,u.dimensions]]),e[37]||(e[37]=t("span",null,"尺寸规格",-1))]),v(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[7]||(e[7]=s=>c.dimensions=s),disabled:!u.dimensions,placeholder:"例如：500ml"},null,8,zt),[[S,c.dimensions]])]),t("div",Ot,[t("label",Et,[v(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=s=>u.features=s)},null,512),[[oe,u.features]]),e[38]||(e[38]=t("span",null,"功能特征",-1))]),v(t("textarea",{class:"form-input","onUpdate:modelValue":e[9]||(e[9]=s=>c.featuresText=s),disabled:!u.features,rows:"2",placeholder:"每行一个特征"},null,8,At),[[S,c.featuresText]])]),t("div",Dt,[t("label",Rt,[v(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=s=>u.characteristics=s)},null,512),[[oe,u.characteristics]]),e[39]||(e[39]=t("span",null,"产品特点",-1))]),v(t("textarea",{class:"form-input","onUpdate:modelValue":e[11]||(e[11]=s=>c.characteristicsText=s),disabled:!u.characteristics,rows:"2",placeholder:"每行一个特点"},null,8,Ht),[[S,c.characteristicsText]])])])):(i(),n("div",Ft," 选择产品后将自动填充名称、规格与特征信息。 "))])]),t("section",Nt,[t("div",qt,[t("div",{class:"panel-header"},[e[41]||(e[41]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"2"),t("div",null,[t("h3",null,"模板与标签"),t("p",{class:"panel-subtitle"},"点击标签可多选，支持就地编辑")])],-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:ze},[...e[40]||(e[40]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),V(" 重置模板 ",-1)])])]),t("div",Xt,[t("div",Gt,[t("div",Jt,[e[43]||(e[43]=t("span",{class:"module-title"},"场景选择",-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[12]||(e[12]=s=>se("scene"))},[...e[42]||(e[42]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",Zt,[(i(!0),n(f,null,b(d.scene,s=>(i(),n("div",{key:s.id,class:C(["option-chip",{selected:x.scene.includes(s.id),editing:_("scene",s.id)}])},[_("scene",s.id)?v((i(),n("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:L,onKeydown:ae(k(L,["prevent"]),["enter"])},null,40,Wt)),[[S,s.label]]):(i(),n("span",{key:0,onClick:o=>te("scene",s.id)},r(s.label),9,Qt)),_("scene",s.id)?p("",!0):(i(),n("button",{key:2,class:"chip-edit",onClick:k(o=>F("scene",s.id),["stop"])},[...e[44]||(e[44]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Yt)),t("button",{class:"chip-delete",onClick:k(o=>H("scene",s.id),["stop"])},[...e[45]||(e[45]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,es)],2))),128))])]),t("div",ts,[t("div",ss,[e[47]||(e[47]=t("span",{class:"module-title"},"拍摄角度",-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[13]||(e[13]=s=>se("angle"))},[...e[46]||(e[46]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",ls,[(i(!0),n(f,null,b(d.angle,s=>(i(),n("div",{key:s.id,class:C(["option-chip",{selected:x.angle.includes(s.id),editing:_("angle",s.id)}])},[_("angle",s.id)?v((i(),n("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:L,onKeydown:ae(k(L,["prevent"]),["enter"])},null,40,is)),[[S,s.label]]):(i(),n("span",{key:0,onClick:o=>te("angle",s.id)},r(s.label),9,ns)),_("angle",s.id)?p("",!0):(i(),n("button",{key:2,class:"chip-edit",onClick:k(o=>F("angle",s.id),["stop"])},[...e[48]||(e[48]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,os)),t("button",{class:"chip-delete",onClick:k(o=>H("angle",s.id),["stop"])},[...e[49]||(e[49]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,as)],2))),128))])]),t("div",rs,[t("div",ds,[e[51]||(e[51]=t("span",{class:"module-title"},[V("风格 / 光影 "),t("span",{class:"optional-tag"},"(可选)")],-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[14]||(e[14]=s=>se("style"))},[...e[50]||(e[50]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",cs,[(i(!0),n(f,null,b(d.style,s=>(i(),n("div",{key:s.id,class:C(["option-chip",{selected:x.style.includes(s.id),editing:_("style",s.id)}])},[_("style",s.id)?v((i(),n("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:L,onKeydown:ae(k(L,["prevent"]),["enter"])},null,40,ps)),[[S,s.label]]):(i(),n("span",{key:0,onClick:o=>te("style",s.id)},r(s.label),9,us)),_("style",s.id)?p("",!0):(i(),n("button",{key:2,class:"chip-edit",onClick:k(o=>F("style",s.id),["stop"])},[...e[52]||(e[52]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,vs)),t("button",{class:"chip-delete",onClick:k(o=>H("style",s.id),["stop"])},[...e[53]||(e[53]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,ms)],2))),128))])]),t("div",gs,[t("div",hs,[e[55]||(e[55]=t("span",{class:"module-title"},"生成目标",-1)),t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[15]||(e[15]=s=>se("target"))},[...e[54]||(e[54]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),t("div",ys,[(i(!0),n(f,null,b(d.target,s=>(i(),n("div",{key:s.id,class:C(["option-chip",{selected:x.target.includes(s.id),editing:_("target",s.id)}])},[_("target",s.id)?v((i(),n("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:L,onKeydown:ae(k(L,["prevent"]),["enter"])},null,40,bs)),[[S,s.label]]):(i(),n("span",{key:0,onClick:o=>te("target",s.id)},r(s.label),9,fs)),_("target",s.id)?p("",!0):(i(),n("button",{key:2,class:"chip-edit",onClick:k(o=>F("target",s.id),["stop"])},[...e[56]||(e[56]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,ks)),t("button",{class:"chip-delete",onClick:k(o=>H("target",s.id),["stop"])},[...e[57]||(e[57]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,ws)],2))),128))])])]),t("div",xs,[t("div",{class:"template-editor-header"},[e[59]||(e[59]=t("div",null,[t("h4",null,"提示词模板"),t("p",{class:"template-editor-subtitle"},"自定义提示词结构，可插入变量")],-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:Ae},[...e[58]||(e[58]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),V(" 重置模板 ",-1)])])]),t("div",_s,[e[61]||(e[61]=t("div",{class:"template-editor-hint"},[V(" 使用 "),t("code",{textContent:"{{变量名}}"}),V(" 插入变量，支持默认值： "),t("code",{textContent:"{{变量名|默认值}}"})],-1)),v(t("textarea",{class:"form-input template-textarea","onUpdate:modelValue":e[16]||(e[16]=s=>z.value=s),rows:"4",placeholder:"输入提示词模板...",onInput:be},null,544),[[S,z.value]]),t("div",Cs,[e[60]||(e[60]=t("div",{class:"variable-title"},"可用变量",-1)),t("div",Ts,[(i(!0),n(f,null,b(Ce.value,s=>(i(),n("span",{class:"variable-chip",key:s.name,onClick:o=>De(s.name),title:s.description},[t("code",{textContent:r("{{"+s.name+"}}")},null,8,$s),s.currentValue?(i(),n("span",Ss,r(Re(s.currentValue)),1)):p("",!0)],8,Bs))),128))])])])])])]),t("section",Vs,[t("div",Us,[t("div",Ms,[e[62]||(e[62]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"3"),t("div",null,[t("h3",null,"提示词预览"),t("p",{class:"panel-subtitle"},"分段预览并高亮关键变量")])],-1)),M.value?p("",!0):(i(),n("span",Is,"完善产品信息与模板后自动生成"))]),t("div",Ps,[t("div",Ks,[e[63]||(e[63]=t("span",{class:"prompt-label"},"产品信息",-1)),t("div",{class:C(["prompt-value",{empty:g.value.product.length===0}])},[g.value.product.length?(i(!0),n(f,{key:0},b(g.value.product,(s,o)=>(i(),n("span",{key:`product-${o}`,class:"prompt-chip"},r(s),1))),128)):(i(),n("span",js,"未选择或未填写"))],2)]),t("div",Ls,[e[64]||(e[64]=t("span",{class:"prompt-label"},"场景",-1)),t("div",{class:C(["prompt-value",{empty:g.value.scene.length===0}])},[g.value.scene.length?(i(!0),n(f,{key:0},b(g.value.scene,(s,o)=>(i(),n("span",{key:`scene-${o}`,class:"prompt-chip"},r(s),1))),128)):(i(),n("span",zs,"未选择场景"))],2)]),t("div",Os,[e[65]||(e[65]=t("span",{class:"prompt-label"},"角度",-1)),t("div",{class:C(["prompt-value",{empty:g.value.angle.length===0}])},[g.value.angle.length?(i(!0),n(f,{key:0},b(g.value.angle,(s,o)=>(i(),n("span",{key:`angle-${o}`,class:"prompt-chip"},r(s),1))),128)):(i(),n("span",Es,"未选择角度"))],2)]),t("div",As,[e[66]||(e[66]=t("span",{class:"prompt-label"},"风格 / 光影",-1)),t("div",{class:C(["prompt-value",{empty:g.value.style.length===0}])},[g.value.style.length?(i(!0),n(f,{key:0},b(g.value.style,(s,o)=>(i(),n("span",{key:`style-${o}`,class:"prompt-chip"},r(s),1))),128)):(i(),n("span",Ds,"未选择风格"))],2)]),t("div",Rs,[e[67]||(e[67]=t("span",{class:"prompt-label"},"生成目标",-1)),t("div",{class:C(["prompt-value",{empty:g.value.target.length===0}])},[g.value.target.length?(i(!0),n(f,{key:0},b(g.value.target,(s,o)=>(i(),n("span",{key:`target-${o}`,class:"prompt-chip"},r(s),1))),128)):(i(),n("span",Hs,"未选择目标"))],2)])]),t("div",Fs,[t("div",Ns,[e[69]||(e[69]=t("div",null,[t("h4",null,"完整 Prompt"),t("p",{class:"prompt-full-hint"},"可直接复制用于生成")],-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:Fe,disabled:!M.value},[...e[68]||(e[68]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),V(" 复制 ",-1)])],8,qs)]),t("div",Xs,[M.value?(i(),n("p",Gs,r(M.value),1)):(i(),n("p",Js,"选择产品和模板选项后，提示词将在这里生成。"))])])])]),t("section",Zs,[t("div",Qs,[t("div",Ws,[e[70]||(e[70]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"4"),t("div",null,[t("h3",null,"生成与结果"),t("p",{class:"panel-subtitle"},"确认参考图与提示词后开始生成")])],-1)),Y.value?(i(),n("span",Ys,r(Y.value),1)):p("",!0)]),t("div",el,[!$.value&&!A.value?(i(),n("div",tl,[...e[71]||(e[71]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t("polyline",{points:"21 15 16 10 5 21"})],-1),t("h3",null,"准备生成",-1),t("p",null,"选择产品、参考图片与模板选项，然后点击生成。",-1)])])):p("",!0),$.value?(i(),n("div",sl,[...e[72]||(e[72]=[t("div",{class:"spinner"},null,-1),t("p",null,"正在生成图片...",-1)])])):p("",!0),A.value&&!$.value?(i(),n("div",ll,[t("img",{src:A.value,alt:"Generated image",class:"result-image"},null,8,nl),t("div",{class:"result-actions"},[t("button",{class:"btn btn-secondary",onClick:Ne},[...e[73]||(e[73]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t("polyline",{points:"7 10 12 15 17 10"}),t("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1),V(" 下载 ",-1)])]),t("button",{class:"btn btn-primary",onClick:ke},[...e[74]||(e[74]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),V(" 重新生成 ",-1)])])])])):p("",!0)]),t("div",il,[t("button",{class:"generate-btn",disabled:!ye.value||$.value,onClick:ke},[$.value?(i(),n("div",rl)):(i(),n("svg",al,[...e[75]||(e[75]=[t("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},null,-1)])])),V(" "+r($.value?"生成中...":"生成电商图"),1)],8,ol),Y.value?(i(),n("div",dl,r(Y.value),1)):p("",!0)])])])])]),t("div",cl,[(i(!0),n(f,null,b(Z.value,s=>(i(),n("div",{key:s.id,class:C(["toast",s.type])},r(s.message),3))),128))]),D.value?(i(),n("div",{key:0,class:"error-overlay",onClick:e[19]||(e[19]=s=>D.value="")},[t("div",{class:"error-modal",onClick:e[18]||(e[18]=k(()=>{},["stop"]))},[e[76]||(e[76]=N('<div class="error-header"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg><h3>生成失败</h3></div>',1)),t("p",null,r(D.value),1),t("button",{class:"btn btn-primary",onClick:e[17]||(e[17]=s=>D.value="")},"确定")])])):p("",!0)]))}});Qe(ul).mount("#app");
