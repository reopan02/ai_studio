import{d as lt,a as l,b as i,n as _,e as t,C as ie,m as oe,u as m,f as c,D as Ue,t as a,T as it,E as K,w as f,v as St,q as Z,r as h,c as A,A as Me,o as Bt,z as Ut,g as ve,F as $,p as T,B as Ge,l as V,i as ee,G as ze,s as me,x as Mt,y as zt,H as It,j as Pt,k as Vt}from"./supabase-yVp6g-J3.js";/* empty css                        */const Kt=["aria-expanded","onKeydown"],Lt={class:"collapsible-title"},jt={class:"collapsible-title-text"},Et={key:0,class:"collapsible-summary"},Ot={class:"collapsible-actions"},At={class:"collapsible-body"},Ie=lt({__name:"CollapsibleGroup",props:{title:{},summary:{},open:{type:Boolean}},emits:["toggle"],setup(Q,{emit:L}){const te=L;function u(){te("toggle")}return(se,B)=>(i(),l("div",{class:_(["collapsible-group",{collapsed:!Q.open}])},[t("div",{class:"collapsible-header",role:"button",tabindex:"0","aria-expanded":Q.open,onClick:u,onKeydown:[oe(m(u,["prevent"]),["enter"]),oe(m(u,["prevent"]),["space"])]},[t("div",Lt,[t("span",jt,a(Q.title),1),Ue(se.$slots,"title-extra")]),Q.open?c("",!0):(i(),l("div",Et,[Ue(se.$slots,"summary",{},()=>[t("span",null,a(Q.summary),1)])])),t("div",Ot,[Ue(se.$slots,"actions"),B[0]||(B[0]=t("span",{class:"collapsible-toggle"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"6 9 12 15 18 9"})])],-1))])],40,Kt),ie(it,{name:"collapse"},{default:K(()=>[f(t("div",At,[Ue(se.$slots,"default")],512),[[St,Q.open]])]),_:3})],2))}}),Dt={class:"ecommerce-image-page"},Ht={class:"wizard-nav"},Gt={class:"wizard-steps"},Nt=["aria-current","aria-disabled","onClick"],Rt={class:"wizard-step-indicator"},qt={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},Ft={key:1},Jt={class:"wizard-step-label"},Xt={key:0,class:"wizard-step-hint"},Zt={class:"main-container"},Qt={class:"sidebar"},Wt={class:"sidebar-section"},Yt={class:"form-group",style:{"margin-top":"16px"}},es={class:"form-group"},ts={class:"form-group"},ss={class:"sidebar-section"},ns={class:"search-wrapper"},ls={key:0,class:"product-list"},is=["onClick"],os=["src","alt"],as={class:"product-info"},rs={class:"product-name"},ds={class:"product-meta"},us={key:1,class:"product-list-empty"},cs={key:2,class:"product-list-loading"},ps={key:3,class:"pagination"},vs=["disabled"],ms={class:"page-info"},gs=["disabled"],hs={key:0,class:"sidebar-section"},fs={class:"section-title"},ys={key:0,class:"image-grid"},bs=["onClick"],ks=["src"],ws={key:0,class:"image-check"},_s={key:1,class:"image-primary"},xs={key:1,class:"no-images"},Cs={class:"main-content"},$s={key:0,class:"workflow-section"},Ts={class:"content-panel"},Ss={class:"panel-header"},Bs={key:0,class:"panel-hint"},Us={key:0,class:"product-fields"},Ms={class:"field-row"},zs={class:"field-checkbox"},Is=["disabled"],Ps={class:"field-row"},Vs={class:"field-checkbox"},Ks=["disabled"],Ls={class:"field-row"},js={class:"field-checkbox"},Es=["disabled"],Os={class:"field-row"},As={class:"field-checkbox"},Ds=["disabled"],Hs={key:1,class:"panel-empty"},Gs={key:1,class:"workflow-section"},Ns={class:"content-panel"},Rs={class:"template-modules"},qs={class:"option-chips"},Fs=["onClick"],Js=["onUpdate:modelValue","data-option-id","onKeydown"],Xs=["onClick"],Zs=["onClick"],Qs={class:"option-chips"},Ws=["onClick"],Ys=["onUpdate:modelValue","data-option-id","onKeydown"],en=["onClick"],tn=["onClick"],sn={class:"option-chips"},nn=["onClick"],ln=["onUpdate:modelValue","data-option-id","onKeydown"],on=["onClick"],an=["onClick"],rn={class:"option-chips"},dn=["onClick"],un=["onUpdate:modelValue","data-option-id","onKeydown"],cn=["onClick"],pn=["onClick"],vn={class:"template-editor"},mn={class:"template-editor-section"},gn={key:2,class:"workflow-section"},hn={class:"content-panel prompt-preview-panel"},fn={class:"panel-header"},yn={key:0,class:"panel-hint"},bn={class:"prompt-structured"},kn={class:"prompt-row"},wn={key:1,class:"prompt-empty"},_n={class:"prompt-row"},xn={key:1,class:"prompt-empty"},Cn={class:"prompt-row"},$n={key:1,class:"prompt-empty"},Tn={class:"prompt-row"},Sn={key:1,class:"prompt-empty"},Bn={class:"prompt-row"},Un={key:1,class:"prompt-empty"},Mn={class:"prompt-full"},zn={class:"prompt-full-header"},In=["disabled"],Pn={class:"prompt-full-body"},Vn={key:0},Kn={key:1,class:"prompt-placeholder"},Ln={key:3,class:"workflow-section"},jn={class:"content-panel"},En={class:"panel-header"},On={key:0,class:"panel-hint"},An={class:"result-area"},Dn={key:0,class:"result-placeholder"},Hn={key:1,class:"loading-state"},Gn={key:2,class:"result-container"},Nn=["src"],Rn={key:0,class:"result-grid"},qn=["onClick"],Fn=["src","alt"],Jn={class:"result-thumb-index"},Xn={class:"result-actions"},Zn={class:"generate-section"},Qn=["disabled"],Wn={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Yn={key:1,class:"spinner-small"},el={key:0,class:"generate-hint"},tl={class:"preview-panel"},sl={class:"preview-card"},nl={class:"preview-card-header"},ll={key:0,class:"preview-card-hint"},il={class:"preview-card-body"},ol={key:0},al={key:1,class:"preview-placeholder"},rl={class:"preview-card"},dl={class:"preview-card-body preview-result"},ul={key:0,class:"preview-loading"},cl={key:1},pl=["src"],vl={key:2,class:"preview-placeholder"},ml={class:"lightbox-body"},gl=["src"],hl={class:"lightbox-footer"},fl={key:0,class:"lightbox-nav"},yl={class:"lightbox-index"},bl={class:"lightbox-actions"},kl={class:"toast-container"},nt="高清产品摄影",Pe=10,wl=lt({__name:"ecommerce-image-page",setup(Q){const L={scene:[{id:"scene-white",label:"白色背景"},{id:"scene-natural-table",label:"自然光桌面"},{id:"scene-outdoor",label:"户外场景"},{id:"scene-solid",label:"纯色背景"},{id:"scene-life",label:"生活场景"}],angle:[{id:"angle-front",label:"正面"},{id:"angle-45",label:"45度侧面"},{id:"angle-top",label:"俯视"},{id:"angle-eye",label:"平视"},{id:"angle-close",label:"特写"}],style:[{id:"style-soft",label:"柔和光影"},{id:"style-contrast",label:"高对比度"},{id:"style-natural",label:"自然光"},{id:"style-studio",label:"专业棚拍"},{id:"style-warm",label:"暖色调"}],target:[{id:"target-main",label:"主图"},{id:"target-detail",label:"详情页"},{id:"target-poster",label:"海报"},{id:"target-white",label:"白底图"},{id:"target-scene",label:"场景图"}]},te=Z({apiKey:"",baseUrl:""}),u=Z({model:"gemini-3-pro-image-preview",aspectRatio:"",imageSize:"1K",n:1}),se=[{id:1,title:"选择产品"},{id:2,title:"配置模板"},{id:3,title:"预览提示词"},{id:4,title:"生成图片"}],B=h(1),ae=h(""),ge=h([]),he=h(!1),fe=h(""),D=h(1),Ve=h(0),U=h(null),j=h([]),x=h([]),y=Z({name:"",dimensions:"",featuresText:"",characteristicsText:""}),b=Z({name:!0,dimensions:!0,features:!0,characteristics:!0}),p=Z({scene:L.scene.map(n=>({...n})),angle:L.angle.map(n=>({...n})),style:L.style.map(n=>({...n})),target:L.target.map(n=>({...n}))}),v=Z({scene:[],angle:[],style:[],target:[]}),R=Z({scene:!0,angle:!1,style:!1,target:!1}),ye=h(!1),k=Z({category:"",id:""}),q=h(nt),I=h(!1),E=h(""),M=h([]),ne=h(""),be=h([]),re=h(!1),H=h(0),Ne=A(()=>{const n=M.value;if(!n.length)return"";const e=Math.min(n.length-1,Math.max(0,H.value));return n[e]||""}),Ke=A(()=>Math.ceil(Ve.value/Pe));function Le(n){return globalThis.crypto&&"randomUUID"in globalThis.crypto?`${n}-${globalThis.crypto.randomUUID()}`:`${n}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function Re(n){return n.split(`
`).map(e=>e.trim()).filter(Boolean)}function qe(n){return n.filter(Boolean).join("、")}function ke(n){const e=new Set(v[n]);return p[n].filter(s=>e.has(s.id)).map(s=>s.label.trim()).filter(Boolean)}function z(n,e){return k.category===n&&k.id===e}const G=A(()=>({scene:ke("scene"),angle:ke("angle"),style:ke("style"),target:ke("target")})),ot=A(()=>v.scene.length>0||v.angle.length>0||v.style.length>0||v.target.length>0);function we(n){const e=G.value[n];return e.length?e.length<=2?e.join("、"):`${e[0]}、${e[1]} 等${e.length}项`:"未选择"}function _e(n){R[n]=!R[n],ye.value=!0}function je(n=!1){if(ye.value&&!n)return;const e=["scene","angle","style","target"];let s=!1;e.forEach(o=>{!s&&v[o].length===0?(R[o]=!0,s=!0):R[o]=!1}),ye.value=!1}const Ee=A(()=>{const n=[],e=y.name.trim(),s=y.dimensions.trim();return b.name&&e&&n.push(e),b.dimensions&&s&&n.push(s),b.features&&n.push(...Re(y.featuresText)),b.characteristics&&n.push(...Re(y.characteristicsText)),n}),w=A(()=>({product:Ee.value,scene:G.value.scene,angle:G.value.angle,style:G.value.style,target:G.value.target}));function xe(n,e){return e.length?`${n}：${qe(e)}`:""}function Fe(n){return n.replace(/[，、]{2,}/g,"，").replace(/^[，、\s]+/,"").replace(/[，、\s]+$/,"").replace(/\s*[，、]\s*/g,"，").trim()}function Oe(n){if(!n)return"";const e=n.trim();if(!e.includes("{{"))return e;const s=e.replace(/\{\{(\w+)(?:\|([^}]*))?\}\}/g,(o,r,g)=>g??"");return Fe(s)}const C=A(()=>{if(!U.value)return"";const n=[];Ee.value.length&&n.push(qe(Ee.value));const e=xe("场景",G.value.scene);e&&n.push(e);const s=xe("拍摄角度",G.value.angle);s&&n.push(s);const o=xe("风格",G.value.style);o&&n.push(o);const r=xe("生成目标",G.value.target);r&&n.push(r);const g=Oe(q.value);return g&&n.push(g),Fe(n.join("，"))}),Je=A(()=>U.value&&x.value.length>0&&C.value.length>0),Ce=A(()=>I.value?"正在生成图片...":U.value?x.value.length===0?"请选择至少一张参考图片":C.value?"":"请完善模板选项或产品信息":"请先在左侧选择产品");function F(n){return n===1?!!U.value&&x.value.length>0:n===2?ot.value:n===3?C.value.length>0:n===4?E.value.length>0:!1}const Xe=A(()=>F(1)?F(2)?F(3)?4:3:2:1);function Ae(n){return n<=Xe.value}function at(){return F(1)?F(2)?F(3)?"请先完成前置步骤":"请先完成步骤3：完善提示词预览":"请先完成步骤2：至少选择一个模板选项":"请先完成步骤1：选择产品并勾选参考图"}function rt(n){if(Ae(n)){B.value=n,ae.value="";return}ae.value=at()}function dt(n){return String(n||"").trim().replace(/^bearer\s+/i,"").trim()}function ut(n){return String(n||"").trim()||null}function De(n){if(!n||typeof n!="object")return[];const e=[];if(Array.isArray(n.data))for(const s of n.data)!s||typeof s!="object"||(typeof s.url=="string"&&s.url?e.push(s.url):typeof s.b64_json=="string"&&s.b64_json?e.push(`data:image/png;base64,${s.b64_json}`):typeof s.image_url=="string"&&s.image_url?e.push(s.image_url):typeof s.imageUrl=="string"&&s.imageUrl&&e.push(s.imageUrl));return typeof n.url=="string"&&n.url&&e.push(n.url),typeof n.b64_json=="string"&&n.b64_json&&e.push(`data:image/png;base64,${n.b64_json}`),typeof n.image_url=="string"&&n.image_url&&e.push(n.image_url),typeof n.imageUrl=="string"&&n.imageUrl&&e.push(n.imageUrl),Array.from(new Set(e))}async function $e(){he.value=!0;try{const n=(D.value-1)*Pe,e=n+Pe-1;let s=me.from("products").select("id,name,dimensions,features,characteristics,original_image_url,created_at",{count:"exact"}).order("created_at",{ascending:!1}).range(n,e);fe.value&&(s=s.ilike("name",`%${fe.value}%`));const{data:o,error:r,count:g}=await s;if(r)throw r;const d=o||[],Y=d.map(N=>N.id),O=new Map;if(Y.length){const{data:N,error:S}=await me.from("product_images").select("id,product_id,image_url,is_primary").in("product_id",Y);if(S)throw S;for(const P of N||[]){const X=P.product_id,ce={id:P.id,image_url:P.image_url,is_primary:!!P.is_primary},pe=O.get(X)||[];pe.push(ce),O.set(X,pe)}}ge.value=d.map(N=>{const S=O.get(N.id)||[];return{...N,images:S,image_count:S.length||1}}),Ve.value=g||0}catch{W("加载产品列表失败","error")}finally{he.value=!1}}function ct(){D.value=1,$e()}function pt(){D.value>1&&(D.value--,$e())}function vt(){D.value<Ke.value&&(D.value++,$e())}function mt(n){if(n.images&&n.images.length>0){const e=n.images.find(s=>s.is_primary);return e?e.image_url:n.images[0].image_url}return n.original_image_url||"/static/placeholder.png"}async function gt(n){U.value=n;try{const{data:e,error:s}=await me.from("products").select("*").eq("id",n.id).single();if(s)throw s;const{data:o,error:r}=await me.from("product_images").select("id,image_url,is_primary").eq("product_id",n.id).order("is_primary",{ascending:!1});if(r)throw r;y.name=e.name||"",y.dimensions=e.dimensions||"",y.featuresText=(e.features||[]).join(`
`),y.characteristicsText=(e.characteristics||[]).join(`
`),j.value=o||[];const g=e.original_image_url;j.value.length===0&&g&&(j.value=[{id:e.id,image_url:g,is_primary:!0}]);const d=j.value.find(Y=>Y.is_primary);d?x.value=[d.id]:j.value.length>0?x.value=[j.value[0].id]:x.value=[]}catch{W("加载产品详情失败","error")}}function ht(n){const e=x.value.indexOf(n);e===-1?x.value.push(n):x.value.splice(e,1)}function ft(n,e){return p[n].find(s=>s.id===e)??null}function yt(n){It(()=>{const e=document.querySelector(`.option-edit-input[data-option-id="${n}"]`);e&&(e.focus(),e.select())})}function Te(n,e){const s=v[n],o=s.indexOf(e);o===-1?s.push(e):s.splice(o,1)}function Se(n){const e={id:Le(n),label:"新选项"};p[n].push(e),He(),ue(n,e.id)}function de(n,e){const s=p[n].findIndex(r=>r.id===e);if(s===-1)return;p[n].splice(s,1);const o=v[n].indexOf(e);o!==-1&&v[n].splice(o,1),k.category===n&&k.id===e&&(k.category="",k.id=""),He()}function ue(n,e){k.category=n,k.id=e,yt(e)}function J(){if(!k.category||!k.id)return;const n=k.category,e=k.id;k.category="",k.id="";const s=ft(n,e);if(!s)return;const o=s.label.trim();if(!o){de(n,e);return}s.label=o,He()}function bt(){p.scene=L.scene.map(n=>({...n})),p.angle=L.angle.map(n=>({...n})),p.style=L.style.map(n=>({...n})),p.target=L.target.map(n=>({...n})),v.scene=[],v.angle=[],v.style=[],v.target=[],k.category="",k.id="",ye.value=!1,je(!0),localStorage.removeItem("ecommerce-image-templates"),W("模板已重置为默认值","success")}function He(){const n={version:2,templates:{scene:p.scene.map(e=>({id:e.id,label:e.label})),angle:p.angle.map(e=>({id:e.id,label:e.label})),style:p.style.map(e=>({id:e.id,label:e.label})),target:p.target.map(e=>({id:e.id,label:e.label}))}};localStorage.setItem("ecommerce-image-templates",JSON.stringify(n))}function Be(n,e){if(!Array.isArray(n))return null;const s=[];for(const o of n){if(typeof o=="string"){const r=o.trim();r&&s.push({id:Le(e),label:r});continue}if(o&&typeof o=="object"){const r=typeof o.label=="string"?o.label.trim():"";if(!r)continue;const g=typeof o.id=="string"?String(o.id):Le(e);s.push({id:g,label:r})}}return s.length?s:null}function kt(){const n=localStorage.getItem("ecommerce-image-templates");if(n)try{const e=JSON.parse(n),s=(e==null?void 0:e.templates)||e,o=Be(s==null?void 0:s.scene,"scene"),r=Be(s==null?void 0:s.angle,"angle"),g=Be(s==null?void 0:s.style,"style"),d=Be(s==null?void 0:s.target,"target");o&&(p.scene=o),r&&(p.angle=r),g&&(p.style=g),d&&(p.target=d)}catch{}}function wt(){const n=Oe(q.value);n!==q.value&&(q.value=n),localStorage.setItem("ecommerce-image-prompt-template",n)}function _t(){const n=localStorage.getItem("ecommerce-image-prompt-template");n&&(q.value=Oe(n))}function xt(){q.value=nt,localStorage.removeItem("ecommerce-image-prompt-template"),W("提示词模板已重置为默认值","success")}function Ct(){te.apiKey=localStorage.getItem("global_api_key")||localStorage.getItem("video_api_key")||void 0||"",te.baseUrl=localStorage.getItem("global_base_url")||localStorage.getItem("video_base_url")||void 0||""}async function $t(){if(C.value)try{await navigator.clipboard.writeText(C.value),W("提示词已复制到剪贴板","success")}catch{W("复制失败","error")}}async function Ze(){if(!(!Je.value||I.value)){I.value=!0,ne.value="",le();try{const n=Math.min(10,Math.max(1,Math.floor(Number(u.n)||1)));if(u.n=n,n>=6&&!confirm(`将并发生成 ${n} 张图片，确认继续？`))return;const e=new FormData;e.append("prompt",C.value),e.append("model",u.model),e.append("n",String(n)),e.append("response_format","url"),u.aspectRatio&&e.append("aspect_ratio",u.aspectRatio),u.imageSize&&e.append("image_size",u.imageSize);for(const S of x.value){const P=j.value.find(X=>X.id===S);if(P)try{const ce=await(await fetch(P.image_url)).blob();e.append("image",ce,`ref-${S}.jpg`)}catch{console.warn("Failed to fetch reference image:",P.image_url)}}const s={},o=dt(te.apiKey);o&&(s["X-API-Key"]=o);const r=ut(te.baseUrl);r&&(s["X-Base-Url"]=r);const g=await Mt("/api/v1/images/edits",{method:"POST",headers:s,body:e});if(!g.ok){const S=await g.json().catch(()=>({}));throw new Error(S.detail||`HTTP ${g.status}`)}const d=await g.json(),Y=d&&typeof d=="object"&&d.response?d.response:d,O=De(Y).length?De(Y):De(d);if(O.length)M.value=O,E.value=O[0]||"";else throw new Error("Invalid response format");W(O.length>1?`图片生成成功（${O.length}张）`:"图片生成成功","success");const N=await zt();if(N){const S=O.map((X,ce)=>{var pe,st;return{user_id:N,title:(pe=U.value)!=null&&pe.name?`电商图 - ${U.value.name}`:null,model:u.model,prompt:C.value,status:"completed",image_url:X,metadata:{source:"ecommerce-image",product_id:((st=U.value)==null?void 0:st.id)||null,selected_templates:{scene:[...v.scene],angle:[...v.angle],style:[...v.style],target:[...v.target]},selected_images:x.value,aspect_ratio:u.aspectRatio||null,image_size:u.imageSize||null,index:ce},request:d&&typeof d=="object"&&d.request?d.request:null,response:d&&typeof d=="object"&&d.response?d.response:d}}),{error:P}=await me.from("user_images").insert(S);P&&console.warn("Failed to save images to repository:",P)}}catch(n){ne.value=n.message||"生成失败，请重试"}finally{I.value=!1}}}function Qe(n){const e=n||E.value;if(!e)return;const s=document.createElement("a");s.href=e,s.download=`ecommerce-${Date.now()}.png`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}function We(n){const e=M.value;if(!e.length)return;const s=n?e.indexOf(n):-1;H.value=s>=0?s:0,re.value=!0}function le(){re.value=!1}function Ye(){const n=M.value.length;n<=1||(H.value=(H.value-1+n)%n)}function et(){const n=M.value.length;n<=1||(H.value=(H.value+1)%n)}function tt(n){if(re.value){if(n.key==="Escape"){n.preventDefault(),le();return}if(n.key==="ArrowLeft"){n.preventDefault(),Ye();return}n.key==="ArrowRight"&&(n.preventDefault(),et())}}let Tt=0;function W(n,e="info"){const s=Tt++;be.value.push({id:s,message:n,type:e}),setTimeout(()=>{const o=be.value.findIndex(r=>r.id===s);o!==-1&&be.value.splice(o,1)},3e3)}return Me(B,n=>{ae.value="",n===2&&je()}),Me(Xe,n=>{B.value>n&&(B.value=n)}),Bt(()=>{kt(),_t(),Ct(),$e(),je(!0),document.addEventListener("keydown",tt)}),Ut(()=>{document.removeEventListener("keydown",tt)}),Me(re,n=>{document.body.style.overflow=n?"hidden":""}),Me(M,n=>{if(!n.length){le();return}H.value>=n.length&&(H.value=0)}),(n,e)=>(i(),l("div",Dt,[e[91]||(e[91]=ve('<header class="header"><div class="logo"><div class="logo-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg></div><span>电商图生成</span></div><div class="header-actions"><a href="/" class="btn btn-secondary" style="text-decoration:none;display:flex;align-items:center;gap:8px;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg> 返回主页面 </a></div></header>',1)),t("nav",Ht,[t("div",Gt,[(i(),l($,null,T(se,s=>t("button",{key:s.id,class:_(["wizard-step",{active:B.value===s.id,completed:F(s.id),disabled:!Ae(s.id)}]),"aria-current":B.value===s.id?"step":void 0,"aria-disabled":!Ae(s.id),onClick:o=>rt(s.id)},[t("span",Rt,[F(s.id)?(i(),l("svg",qt,[...e[30]||(e[30]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("span",Ft,a(s.id),1))]),t("span",Jt,a(s.title),1)],10,Nt)),64))]),ae.value?(i(),l("div",Xt,a(ae.value),1)):c("",!0)]),t("div",Zt,[t("aside",Qt,[t("section",Wt,[e[38]||(e[38]=ve('<div class="section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg> Model Selection </div>',1)),f(t("select",{class:"form-select","onUpdate:modelValue":e[0]||(e[0]=s=>u.model=s)},[...e[31]||(e[31]=[t("option",{value:"gemini-3-pro-image-preview"},"gemini-3-pro-image-preview (推荐)",-1),t("option",{value:"gemini-2.5-flash-image"},"gemini-2.5-flash-image (快速)",-1)])],512),[[Ge,u.model]]),t("div",Yt,[e[33]||(e[33]=t("label",{class:"form-label"},"Aspect Ratio",-1)),f(t("select",{class:"form-select","onUpdate:modelValue":e[1]||(e[1]=s=>u.aspectRatio=s)},[...e[32]||(e[32]=[ve('<option value="">Auto</option><option value="1:1">1:1 (Square)</option><option value="16:9">16:9 (Landscape)</option><option value="9:16">9:16 (Portrait)</option><option value="4:3">4:3</option><option value="3:4">3:4</option><option value="3:2">3:2</option><option value="2:3">2:3</option><option value="4:5">4:5</option><option value="5:4">5:4</option>',10)])],512),[[Ge,u.aspectRatio]])]),t("div",es,[e[35]||(e[35]=t("label",{class:"form-label"},"Image Size",-1)),f(t("select",{class:"form-select","onUpdate:modelValue":e[2]||(e[2]=s=>u.imageSize=s)},[...e[34]||(e[34]=[t("option",{value:""},"Default",-1),t("option",{value:"1K"},"1K",-1),t("option",{value:"2K"},"2K",-1),t("option",{value:"4K"},"4K",-1)])],512),[[Ge,u.imageSize]])]),t("div",ts,[e[36]||(e[36]=t("label",{class:"form-label"},"并发数量",-1)),f(t("input",{class:"form-input",type:"number",min:"1",max:"10","onUpdate:modelValue":e[3]||(e[3]=s=>u.n=s)},null,512),[[V,u.n,void 0,{number:!0}]]),e[37]||(e[37]=t("div",{class:"form-hint"},"一次生成多张图片（1-10）",-1))])]),t("section",ss,[e[44]||(e[44]=ve('<div class="section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 7H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2Z"></path><path d="M9 2v5"></path><path d="M15 2v5"></path><path d="M2 9h20"></path></svg> 选择产品 </div>',1)),t("div",ns,[e[39]||(e[39]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),f(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[4]||(e[4]=s=>fe.value=s),placeholder:"搜索产品...",onInput:ct},null,544),[[V,fe.value]])]),!he.value&&ge.value.length>0?(i(),l("div",ls,[(i(!0),l($,null,T(ge.value,s=>{var o;return i(),l("div",{key:s.id,class:_(["product-item",{selected:((o=U.value)==null?void 0:o.id)===s.id}]),onClick:r=>gt(s)},[t("img",{src:mt(s),alt:s.name,class:"product-thumb"},null,8,os),t("div",as,[t("div",rs,a(s.name||"未命名产品"),1),t("div",ds,a(s.dimensions||""),1)])],10,is)}),128))])):!he.value&&ge.value.length===0?(i(),l("div",us,[...e[40]||(e[40]=[t("p",null,"暂无产品",-1),t("a",{href:"/products",class:"btn btn-secondary btn-sm"},"前往产品库",-1)])])):(i(),l("div",cs,[...e[41]||(e[41]=[t("div",{class:"spinner-small"},null,-1),t("span",null,"加载中...",-1)])])),Ve.value>Pe?(i(),l("div",ps,[t("button",{class:"btn btn-ghost btn-sm",disabled:D.value<=1,onClick:pt},[...e[42]||(e[42]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])],8,vs),t("span",ms,a(D.value)+" / "+a(Ke.value),1),t("button",{class:"btn btn-ghost btn-sm",disabled:D.value>=Ke.value,onClick:vt},[...e[43]||(e[43]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])],8,gs)])):c("",!0)]),U.value?(i(),l("section",hs,[t("div",fs,[e[45]||(e[45]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t("polyline",{points:"21 15 16 10 5 21"})],-1)),ee(" 参考图片 ("+a(x.value.length)+"/"+a(j.value.length)+") ",1)]),j.value.length>0?(i(),l("div",ys,[(i(!0),l($,null,T(j.value,s=>(i(),l("div",{key:s.id,class:_(["image-item",{selected:x.value.includes(s.id)}]),onClick:o=>ht(s.id)},[t("img",{src:s.image_url,alt:"Product image"},null,8,ks),x.value.includes(s.id)?(i(),l("div",ws,[...e[46]||(e[46]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"3"},[t("polyline",{points:"20 6 9 17 4 12"})],-1)])])):c("",!0),s.is_primary?(i(),l("div",_s,"主图")):c("",!0)],10,bs))),128))])):(i(),l("div",xs,[...e[47]||(e[47]=[t("p",null,"该产品暂无图片",-1)])]))])):c("",!0)]),t("main",Cs,[ie(it,{name:"step-fade",mode:"out-in"},{default:K(()=>[B.value===1?(i(),l("section",$s,[t("div",Ts,[t("div",Ss,[e[48]||(e[48]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"1"),t("div",null,[t("h3",null,"产品选择"),t("p",{class:"panel-subtitle"},"选择产品与参考图，并完善提示词字段")])],-1)),U.value?c("",!0):(i(),l("span",Bs,"请先从左侧选择产品"))]),U.value?(i(),l("div",Us,[t("div",Ms,[t("label",zs,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>b.name=s)},null,512),[[ze,b.name]]),e[49]||(e[49]=t("span",null,"产品名称",-1))]),f(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[6]||(e[6]=s=>y.name=s),disabled:!b.name,placeholder:"例如：保温杯"},null,8,Is),[[V,y.name]])]),t("div",Ps,[t("label",Vs,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>b.dimensions=s)},null,512),[[ze,b.dimensions]]),e[50]||(e[50]=t("span",null,"尺寸规格",-1))]),f(t("input",{type:"text",class:"form-input","onUpdate:modelValue":e[8]||(e[8]=s=>y.dimensions=s),disabled:!b.dimensions,placeholder:"例如：500ml"},null,8,Ks),[[V,y.dimensions]])]),t("div",Ls,[t("label",js,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=s=>b.features=s)},null,512),[[ze,b.features]]),e[51]||(e[51]=t("span",null,"功能特征",-1))]),f(t("textarea",{class:"form-input","onUpdate:modelValue":e[10]||(e[10]=s=>y.featuresText=s),disabled:!b.features,rows:"2",placeholder:"每行一个特征"},null,8,Es),[[V,y.featuresText]])]),t("div",Os,[t("label",As,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=s=>b.characteristics=s)},null,512),[[ze,b.characteristics]]),e[52]||(e[52]=t("span",null,"产品特点",-1))]),f(t("textarea",{class:"form-input","onUpdate:modelValue":e[12]||(e[12]=s=>y.characteristicsText=s),disabled:!b.characteristics,rows:"2",placeholder:"每行一个特点"},null,8,Ds),[[V,y.characteristicsText]])])])):(i(),l("div",Hs," 选择产品后将自动填充名称、规格与特征信息。 "))])])):B.value===2?(i(),l("section",Gs,[t("div",Ns,[t("div",{class:"panel-header"},[e[54]||(e[54]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"2"),t("div",null,[t("h3",null,"模板配置"),t("p",{class:"panel-subtitle"},"点击标签可多选，支持就地编辑")])],-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:bt},[...e[53]||(e[53]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),ee(" 重置模板 ",-1)])])]),t("div",Rs,[ie(Ie,{title:"场景选择",summary:we("scene"),open:R.scene,onToggle:e[14]||(e[14]=s=>_e("scene"))},{actions:K(()=>[t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[13]||(e[13]=m(s=>Se("scene"),["stop"]))},[...e[55]||(e[55]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),default:K(()=>[t("div",qs,[(i(!0),l($,null,T(p.scene,s=>(i(),l("div",{key:s.id,class:_(["option-chip",{selected:v.scene.includes(s.id),editing:z("scene",s.id)}])},[z("scene",s.id)?f((i(),l("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:J,onKeydown:oe(m(J,["prevent"]),["enter"])},null,40,Js)),[[V,s.label]]):(i(),l("span",{key:0,onClick:o=>Te("scene",s.id)},a(s.label),9,Fs)),z("scene",s.id)?c("",!0):(i(),l("button",{key:2,class:"chip-edit",onClick:m(o=>ue("scene",s.id),["stop"])},[...e[56]||(e[56]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Xs)),t("button",{class:"chip-delete",onClick:m(o=>de("scene",s.id),["stop"])},[...e[57]||(e[57]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,Zs)],2))),128))])]),_:1},8,["summary","open"]),ie(Ie,{title:"拍摄角度",summary:we("angle"),open:R.angle,onToggle:e[16]||(e[16]=s=>_e("angle"))},{actions:K(()=>[t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[15]||(e[15]=m(s=>Se("angle"),["stop"]))},[...e[58]||(e[58]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),default:K(()=>[t("div",Qs,[(i(!0),l($,null,T(p.angle,s=>(i(),l("div",{key:s.id,class:_(["option-chip",{selected:v.angle.includes(s.id),editing:z("angle",s.id)}])},[z("angle",s.id)?f((i(),l("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:J,onKeydown:oe(m(J,["prevent"]),["enter"])},null,40,Ys)),[[V,s.label]]):(i(),l("span",{key:0,onClick:o=>Te("angle",s.id)},a(s.label),9,Ws)),z("angle",s.id)?c("",!0):(i(),l("button",{key:2,class:"chip-edit",onClick:m(o=>ue("angle",s.id),["stop"])},[...e[59]||(e[59]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,en)),t("button",{class:"chip-delete",onClick:m(o=>de("angle",s.id),["stop"])},[...e[60]||(e[60]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,tn)],2))),128))])]),_:1},8,["summary","open"]),ie(Ie,{title:"风格 / 光影",summary:we("style"),open:R.style,onToggle:e[18]||(e[18]=s=>_e("style"))},{"title-extra":K(()=>[...e[61]||(e[61]=[t("span",{class:"optional-tag"},"(可选)",-1)])]),actions:K(()=>[t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[17]||(e[17]=m(s=>Se("style"),["stop"]))},[...e[62]||(e[62]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),default:K(()=>[t("div",sn,[(i(!0),l($,null,T(p.style,s=>(i(),l("div",{key:s.id,class:_(["option-chip",{selected:v.style.includes(s.id),editing:z("style",s.id)}])},[z("style",s.id)?f((i(),l("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:J,onKeydown:oe(m(J,["prevent"]),["enter"])},null,40,ln)),[[V,s.label]]):(i(),l("span",{key:0,onClick:o=>Te("style",s.id)},a(s.label),9,nn)),z("style",s.id)?c("",!0):(i(),l("button",{key:2,class:"chip-edit",onClick:m(o=>ue("style",s.id),["stop"])},[...e[63]||(e[63]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,on)),t("button",{class:"chip-delete",onClick:m(o=>de("style",s.id),["stop"])},[...e[64]||(e[64]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,an)],2))),128))])]),_:1},8,["summary","open"]),ie(Ie,{title:"生成目标",summary:we("target"),open:R.target,onToggle:e[20]||(e[20]=s=>_e("target"))},{actions:K(()=>[t("button",{class:"btn btn-ghost btn-icon-sm",onClick:e[19]||(e[19]=m(s=>Se("target"),["stop"]))},[...e[65]||(e[65]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1)])])]),default:K(()=>[t("div",rn,[(i(!0),l($,null,T(p.target,s=>(i(),l("div",{key:s.id,class:_(["option-chip",{selected:v.target.includes(s.id),editing:z("target",s.id)}])},[z("target",s.id)?f((i(),l("input",{key:1,type:"text",class:"option-edit-input","onUpdate:modelValue":o=>s.label=o,"data-option-id":s.id,onBlur:J,onKeydown:oe(m(J,["prevent"]),["enter"])},null,40,un)),[[V,s.label]]):(i(),l("span",{key:0,onClick:o=>Te("target",s.id)},a(s.label),9,dn)),z("target",s.id)?c("",!0):(i(),l("button",{key:2,class:"chip-edit",onClick:m(o=>ue("target",s.id),["stop"])},[...e[66]||(e[66]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),t("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,cn)),t("button",{class:"chip-delete",onClick:m(o=>de("target",s.id),["stop"])},[...e[67]||(e[67]=[t("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,pn)],2))),128))])]),_:1},8,["summary","open"])]),t("div",vn,[t("div",{class:"template-editor-header"},[e[69]||(e[69]=t("div",null,[t("h4",null,"提示词模板"),t("p",{class:"template-editor-subtitle"},"系统会自动拼接已选信息，可补充额外描述")],-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:xt},[...e[68]||(e[68]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),ee(" 重置模板 ",-1)])])]),t("div",mn,[e[70]||(e[70]=t("div",{class:"template-editor-hint"}," 已选场景/角度等会自动生成，例如：场景：客厅，拍摄角度：正面。 ",-1)),f(t("textarea",{class:"form-input template-textarea","onUpdate:modelValue":e[21]||(e[21]=s=>q.value=s),rows:"4",placeholder:"补充提示词，如：高清产品摄影",onInput:wt},null,544),[[V,q.value]])])])])])):B.value===3?(i(),l("section",gn,[t("div",hn,[t("div",fn,[e[71]||(e[71]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"3"),t("div",null,[t("h3",null,"提示词预览"),t("p",{class:"panel-subtitle"},"分段预览并高亮关键信息")])],-1)),C.value?c("",!0):(i(),l("span",yn,"完善产品信息与模板后自动生成"))]),t("div",bn,[t("div",kn,[e[72]||(e[72]=t("span",{class:"prompt-label"},"产品信息",-1)),t("div",{class:_(["prompt-value",{empty:w.value.product.length===0}])},[w.value.product.length?(i(!0),l($,{key:0},T(w.value.product,(s,o)=>(i(),l("span",{key:`product-${o}`,class:"prompt-chip"},a(s),1))),128)):(i(),l("span",wn,"未选择或未填写"))],2)]),t("div",_n,[e[73]||(e[73]=t("span",{class:"prompt-label"},"场景",-1)),t("div",{class:_(["prompt-value",{empty:w.value.scene.length===0}])},[w.value.scene.length?(i(!0),l($,{key:0},T(w.value.scene,(s,o)=>(i(),l("span",{key:`scene-${o}`,class:"prompt-chip"},a(s),1))),128)):(i(),l("span",xn,"未选择场景"))],2)]),t("div",Cn,[e[74]||(e[74]=t("span",{class:"prompt-label"},"角度",-1)),t("div",{class:_(["prompt-value",{empty:w.value.angle.length===0}])},[w.value.angle.length?(i(!0),l($,{key:0},T(w.value.angle,(s,o)=>(i(),l("span",{key:`angle-${o}`,class:"prompt-chip"},a(s),1))),128)):(i(),l("span",$n,"未选择角度"))],2)]),t("div",Tn,[e[75]||(e[75]=t("span",{class:"prompt-label"},"风格 / 光影",-1)),t("div",{class:_(["prompt-value",{empty:w.value.style.length===0}])},[w.value.style.length?(i(!0),l($,{key:0},T(w.value.style,(s,o)=>(i(),l("span",{key:`style-${o}`,class:"prompt-chip"},a(s),1))),128)):(i(),l("span",Sn,"未选择风格"))],2)]),t("div",Bn,[e[76]||(e[76]=t("span",{class:"prompt-label"},"生成目标",-1)),t("div",{class:_(["prompt-value",{empty:w.value.target.length===0}])},[w.value.target.length?(i(!0),l($,{key:0},T(w.value.target,(s,o)=>(i(),l("span",{key:`target-${o}`,class:"prompt-chip"},a(s),1))),128)):(i(),l("span",Un,"未选择目标"))],2)])]),t("div",Mn,[t("div",zn,[e[78]||(e[78]=t("div",null,[t("h4",null,"完整 Prompt"),t("p",{class:"prompt-full-hint"},"可直接复制用于生成")],-1)),t("button",{class:"btn btn-ghost btn-sm",onClick:$t,disabled:!C.value},[...e[77]||(e[77]=[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),ee(" 复制 ",-1)])],8,In)]),t("div",Pn,[C.value?(i(),l("p",Vn,a(C.value),1)):(i(),l("p",Kn,"选择产品和模板选项后，提示词将在这里生成。"))])])])])):(i(),l("section",Ln,[t("div",jn,[t("div",En,[e[79]||(e[79]=t("div",{class:"panel-title"},[t("span",{class:"step-indicator"},"4"),t("div",null,[t("h3",null,"生成与结果"),t("p",{class:"panel-subtitle"},"确认参考图与提示词后开始生成")])],-1)),Ce.value?(i(),l("span",On,a(Ce.value),1)):c("",!0)]),t("div",An,[!I.value&&M.value.length===0?(i(),l("div",Dn,[...e[80]||(e[80]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),t("polyline",{points:"21 15 16 10 5 21"})],-1),t("h3",null,"准备生成",-1),t("p",null,"选择产品、参考图片与模板选项，然后点击生成。",-1)])])):c("",!0),I.value?(i(),l("div",Hn,[...e[81]||(e[81]=[t("div",{class:"spinner"},null,-1),t("p",null,"正在生成图片...",-1)])])):c("",!0),M.value.length&&!I.value?(i(),l("div",Gn,[t("img",{src:E.value,alt:"Generated image",class:"result-image",onClick:e[22]||(e[22]=s=>We(E.value))},null,8,Nn),M.value.length>1?(i(),l("div",Rn,[(i(!0),l($,null,T(M.value,(s,o)=>(i(),l("button",{key:`${s}-${o}`,class:_(["result-thumb",{active:s===E.value}]),type:"button",onClick:r=>E.value=s},[t("img",{src:s,alt:`Generated ${o+1}`,loading:"lazy",decoding:"async"},null,8,Fn),t("span",Jn,a(o+1),1)],10,qn))),128))])):c("",!0),t("div",Xn,[t("button",{class:"btn btn-secondary",onClick:e[23]||(e[23]=()=>Qe())},[...e[82]||(e[82]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t("polyline",{points:"7 10 12 15 17 10"}),t("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1),ee(" 下载 ",-1)])]),t("button",{class:"btn btn-primary",onClick:Ze},[...e[83]||(e[83]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"1 4 1 10 7 10"}),t("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1),ee(" 重新生成 ",-1)])])])])):c("",!0)]),t("div",Zn,[t("button",{class:"generate-btn",disabled:!Je.value||I.value,onClick:Ze},[I.value?(i(),l("div",Yn)):(i(),l("svg",Wn,[...e[84]||(e[84]=[t("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},null,-1)])])),ee(" "+a(I.value?"生成中...":"生成电商图"),1)],8,Qn),Ce.value?(i(),l("div",el,a(Ce.value),1)):c("",!0)])])]))]),_:1})]),t("aside",tl,[t("div",sl,[t("div",nl,[e[85]||(e[85]=t("h4",null,"提示词预览",-1)),C.value?c("",!0):(i(),l("span",ll,"完成前两步后显示"))]),t("div",il,[C.value?(i(),l("p",ol,a(C.value),1)):(i(),l("p",al,"选择产品与模板选项后生成提示词。"))])]),t("div",rl,[e[87]||(e[87]=t("div",{class:"preview-card-header"},[t("h4",null,"生成结果")],-1)),t("div",dl,[I.value?(i(),l("div",ul,[...e[86]||(e[86]=[t("div",{class:"spinner-small"},null,-1),t("span",null,"正在生成...",-1)])])):E.value?(i(),l("div",cl,[t("img",{src:E.value,alt:"Generated preview",class:"preview-image",onClick:e[24]||(e[24]=s=>We(E.value))},null,8,pl)])):(i(),l("p",vl,"生成完成后显示结果。"))])])])]),re.value?(i(),l("div",{key:0,class:"lightbox-overlay",onClick:le},[t("div",{class:"lightbox-content",onClick:e[26]||(e[26]=m(()=>{},["stop"]))},[t("div",{class:"lightbox-header"},[e[89]||(e[89]=t("div",{class:"lightbox-title"},"放大预览",-1)),t("button",{class:"btn btn-ghost btn-icon",type:"button",onClick:le,"aria-label":"Close preview"},[...e[88]||(e[88]=[t("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),t("div",ml,[t("img",{src:Ne.value,alt:"Full size preview"},null,8,gl)]),t("div",hl,[M.value.length>1?(i(),l("div",fl,[t("button",{class:"btn btn-secondary btn-sm",type:"button",onClick:Ye},"上一张"),t("span",yl,a(H.value+1)+" / "+a(M.value.length),1),t("button",{class:"btn btn-secondary btn-sm",type:"button",onClick:et},"下一张")])):c("",!0),t("div",bl,[t("button",{class:"btn btn-secondary btn-sm",type:"button",onClick:e[25]||(e[25]=s=>Qe(Ne.value))},"下载"),t("button",{class:"btn btn-ghost btn-sm",type:"button",onClick:le},"关闭")])])])])):c("",!0),t("div",kl,[(i(!0),l($,null,T(be.value,s=>(i(),l("div",{key:s.id,class:_(["toast",s.type])},a(s.message),3))),128))]),ne.value?(i(),l("div",{key:1,class:"error-overlay",onClick:e[29]||(e[29]=s=>ne.value="")},[t("div",{class:"error-modal",onClick:e[28]||(e[28]=m(()=>{},["stop"]))},[e[90]||(e[90]=ve('<div class="error-header"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg><h3>生成失败</h3></div>',1)),t("p",null,a(ne.value),1),t("button",{class:"btn btn-primary",onClick:e[27]||(e[27]=s=>ne.value="")},"确定")])])):c("",!0)]))}});async function _l(){await Pt(),Vt(wl).mount("#app")}_l();
