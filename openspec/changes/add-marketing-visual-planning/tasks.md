# 任务清单：营销视觉策划（两阶段）

## 1. 后端：结构化输出与校验
- [ ] 1.1 在 `app/models/schemas.py` 添加阶段一/阶段二的请求与响应 Schema（含长度与枚举约束）
  - 验证：新增 Pydantic 单测（正例/反例）
- [ ] 1.2 在 `app/clients/llm_client.py` 补充两套系统提示词与 StructLLM 解析入口
  - 验证：本地手动调用样例输入，确认可解析为目标 Schema
- [ ] 1.3 新建 `app/core/marketing_planner.py`，封装阶段一/二编排、字段补全与输出校验
  - 验证：使用 Mock LLM 做单测，覆盖字数、数量、顺序规则
- [ ] 1.4 新增 `app/api/v1/marketing.py`，实现 `POST /api/v1/marketing/strategy` 与 `POST /api/v1/marketing/plan`
  - 验证：API 集成测（含缺参、格式错误、LLM 失败）
- [ ] 1.5 在 `app/main.py` 注册新路由
  - 验证：启动后接口可访问

## 2. 前端：页面与输入
- [ ] 2.1 新增页面入口与路由（`frontend/src/pages/marketing-planner/`，更新 Vite MPA 配置）
  - 验证：页面可打开，基础布局可见
- [ ] 2.2 实现输入区：产品图上传（必填）、产品名称/卖点描述（可选）
  - 验证：缺少产品图时按钮禁用并提示

## 3. 前端：阶段一展示
- [ ] 3.1 实现策略路线卡片列表与“选用此路线”交互
  - 验证：可选中一路线并进入阶段二
- [ ] 3.2 展示产品分析与 3 条海报提示词摘要（只读 + 复制）
  - 验证：字段完整、字数超限提示可见

## 4. 前端：阶段二展示
- [ ] 4.1 展示 8 张图规划列表（顺序固定）与英文 Prompt 预览
  - 验证：items 数量与顺序正确
- [ ] 4.2 统一视觉一致性提示（色彩/字体/元素）
  - 验证：提示内容与选定路线一致

## 5. 交互与错误处理
- [ ] 5.1 阶段一/二调用的 loading、错误提示与重试
  - 验证：LLM 失败时可重试，不清空已选路线

## 6. 测试与验收
- [ ] 6.1 后端测试：Schema 校验 + API 端到端
  - 验证：`pytest` 通过
- [ ] 6.2 前端测试：基础渲染与交互（如有现成测试框架）
  - 验证：`npm test` 或 `npm run test` 通过
